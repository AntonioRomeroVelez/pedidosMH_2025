import{_ as D,r,b as a,d as l,e as s,j as v,f as h,t as u,w as F,y as H,F as j,i as C,s as M}from"./index-CfIIgL4z.js";import{r as R,u as x,a as U}from"./xlsx-eYdzo_tC.js";const I={class:"container py-4",style:{"margin-top":"80px"}},T={class:"row g-4"},W={class:"col-md-6"},$={class:"card shadow-sm"},z={class:"card-body"},L={key:0,class:"mt-2 text-success small"},q={key:1,class:"mt-3"},G=["value"],J={class:"col-md-6"},K={class:"card shadow-sm"},O={class:"card-body"},Q={key:0,class:"mt-2 text-success small"},X={key:1,class:"mt-3"},Y=["value"],Z={class:"text-center mt-4"},ee=["disabled"],oe={key:0,class:"mt-5"},se={class:"table-responsive"},te={class:"table table-bordered table-hover align-middle"},ae={__name:"CompararExcel",setup(le){const m=r([]),b=r([]),c=r([]),k=r(""),g=r(""),S=r(null),P=r(null),y=r([]),_=r([]),p=r(""),f=r("");function N(i,e){const o=i.target.files[0];if(!o)return;const t=new FileReader;t.onload=d=>{const w=new Uint8Array(d.target.result),n=R(w,{type:"array"}),E=n.SheetNames;e==="base"?(S.value=n,y.value=E,k.value=o.name,p.value="",m.value=[]):(P.value=n,_.value=E,g.value=o.name,f.value="",b.value=[])},t.readAsArrayBuffer(o)}function A(i){let e,o,t;if(i==="base"?(e=S.value,o=p.value,t=m):(e=P.value,o=f.value,t=b),!e||!o)return;const d=e.Sheets[o],w=x.sheet_to_json(d,{defval:""});t.value=w.map(n=>({nombre:n.Nombre?.trim()||n.Producto||"",precio:parseFloat(n.Precio)||0,presentacion:n.Presentacion||"",principio_activo:n["Principio Activo"]||"",ica:n.ICA||"",promociones:n.Promocion||n.Promociones||""}))}function V(){const i=new Map(m.value.map(o=>[o.nombre,o])),e=[];for(const o of b.value){const t=i.get(o.nombre);if(!t)e.push({...o,estado:"Nuevo"});else{const d=[];o.precio!==t.precio&&d.push("Precio"),o.promociones!==t.promociones&&d.push("Promoci贸n"),o.presentacion!==t.presentacion&&d.push("Presentaci贸n"),d.length?e.push({...o,estado:"Cambiado",cambios:d}):e.push({...o,estado:"Sin cambios"}),i.delete(o.nombre)}}for(const o of i.values())e.push({...o,estado:"Eliminado"});c.value=e}function B(){if(!c.value.length)return;const i=x.json_to_sheet(c.value),e=x.book_new();x.book_append_sheet(e,i,"Resultado"),U(e,"resultado_comparacion.xlsx")}return(i,e)=>(l(),a("div",I,[e[18]||(e[18]=s("h2",{class:"text-center mb-4"},"Ь Comparador de Archivos Excel",-1)),s("div",T,[s("div",W,[s("div",$,[s("div",z,[e[9]||(e[9]=s("h5",{class:"card-title"},"Archivo anterior",-1)),s("input",{type:"file",accept:".xlsx,.xls",class:"form-control",onChange:e[0]||(e[0]=o=>N(o,"base"))},null,32),k.value?(l(),a("div",L,[e[6]||(e[6]=s("i",{class:"bi bi-file-earmark-excel"},null,-1)),h(" "+u(k.value),1)])):v("",!0),y.value.length?(l(),a("div",q,[e[8]||(e[8]=s("label",{class:"form-label"},"Seleccionar hoja:",-1)),F(s("select",{class:"form-select","onUpdate:modelValue":e[1]||(e[1]=o=>p.value=o),onChange:e[2]||(e[2]=o=>A("base"))},[e[7]||(e[7]=s("option",{disabled:"",value:""},"-- Selecciona una hoja --",-1)),(l(!0),a(j,null,C(y.value,(o,t)=>(l(),a("option",{key:t,value:o},u(o),9,G))),128))],544),[[H,p.value]])])):v("",!0)])])]),s("div",J,[s("div",K,[s("div",O,[e[13]||(e[13]=s("h5",{class:"card-title"},"Archivo nuevo",-1)),s("input",{type:"file",accept:".xlsx,.xls",class:"form-control",onChange:e[3]||(e[3]=o=>N(o,"nuevo"))},null,32),g.value?(l(),a("div",Q,[e[10]||(e[10]=s("i",{class:"bi bi-file-earmark-excel"},null,-1)),h(" "+u(g.value),1)])):v("",!0),_.value.length?(l(),a("div",X,[e[12]||(e[12]=s("label",{class:"form-label"},"Seleccionar hoja:",-1)),F(s("select",{class:"form-select","onUpdate:modelValue":e[4]||(e[4]=o=>f.value=o),onChange:e[5]||(e[5]=o=>A("nuevo"))},[e[11]||(e[11]=s("option",{disabled:"",value:""},"-- Selecciona una hoja --",-1)),(l(!0),a(j,null,C(_.value,(o,t)=>(l(),a("option",{key:t,value:o},u(o),9,Y))),128))],544),[[H,f.value]])])):v("",!0)])])])]),s("div",Z,[s("button",{class:"btn btn-primary px-4 me-2",disabled:!m.value.length||!b.value.length,onClick:V},[...e[14]||(e[14]=[s("i",{class:"bi bi-arrow-repeat"},null,-1),h(" Comparar archivos ",-1)])],8,ee),c.value.length?(l(),a("button",{key:0,class:"btn btn-success px-4",onClick:B},[...e[15]||(e[15]=[s("i",{class:"bi bi-file-earmark-arrow-down"},null,-1),h(" Exportar resultado ",-1)])])):v("",!0)]),c.value.length?(l(),a("div",oe,[e[17]||(e[17]=s("h4",{class:"mb-3"},"Resultado de la comparaci贸n",-1)),s("div",se,[s("table",te,[e[16]||(e[16]=s("thead",{class:"table-light"},[s("tr",null,[s("th",null,"Nombre"),s("th",null,"Precio"),s("th",null,"Promoci贸n"),s("th",null,"Presentaci贸n"),s("th",null,"Estado"),s("th",null,"Cambios")])],-1)),s("tbody",null,[(l(!0),a(j,null,C(c.value,(o,t)=>(l(),a("tr",{key:t,class:M({"table-success":o.estado==="Nuevo","table-danger":o.estado==="Eliminado","table-warning":o.estado==="Cambiado"})},[s("td",null,u(o.nombre),1),s("td",null,u(o.precio),1),s("td",null,u(o.promociones),1),s("td",null,u(o.presentacion),1),s("td",null,[s("strong",null,u(o.estado),1)]),s("td",null,u(o.cambios?.join(", ")),1)],2))),128))])])])])):v("",!0)]))}},ie=D(ae,[["__scopeId","data-v-980249dd"]]);export{ie as default};
