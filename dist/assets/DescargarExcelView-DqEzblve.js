import{u as r,w as m}from"./xlsx-hAyDQTdp.js";import{F as _}from"./FileSaver.min-ox2cZFuQ.js";import{a as g,b,d as f,e as a,h as y,k as h,f as k,n as c}from"./index-BRJqchOp.js";const w={class:"container py-5"},S={class:"text-center d-flex gap-5"},N={__name:"DescargarExcelView",setup(E){const l=()=>{const o=JSON.parse(localStorage.getItem("ListaProductos")||"[]");if(!o.length){c.error("âŒ No hay productos para exportar");return}const t=r.json_to_sheet(o),e=r.book_new();r.book_append_sheet(e,t,"Productos");const s=new Date,p=s.getFullYear(),i=String(s.getMonth()+1).padStart(2,"0"),d=String(s.getDate()).padStart(2,"0"),n=`productos_${p}-${i}-${d}.xlsx`,u=m(e,{bookType:"xlsx",type:"array"}),x=new Blob([u],{type:"application/octet-stream"});_.saveAs(x,n),c.success(`âœ… Excel descargado como ${n}`)};return(o,t)=>{const e=g("RouterLink");return f(),b("div",w,[t[1]||(t[1]=a("h2",{class:"text-primary fw-bold mb-4 text-center"}," ðŸ“¥ Descargar Excel de productos ",-1)),a("div",S,[a("button",{class:"btn btn-success px-4 py-2",onClick:l}," ðŸ“ Descargar Excel "),y(e,{class:"btn btn-outline-warning",to:"/gestionar"},{default:h(()=>[...t[0]||(t[0]=[k("Regresar",-1)])]),_:1})])])}}};export{N as default};
