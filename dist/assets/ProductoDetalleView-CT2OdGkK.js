import{_ as V,u as k,m as E,n as C,r as I,o as $,a as _,b as g,d as p,e as o,w as A,v as J,t as i,f as l,h as v,k as f,p as P}from"./index-CDmx6xWm.js";const L={class:"container mt-5"},M={key:0,class:"card border-0 shadow-sm"},O={class:"card-body"},R={class:"row g-3 align-items-center mb-4"},F={class:"col-4"},B={class:"text-primary fw-bold mb-4"},G={class:"row g-3"},T={class:"col-md-6"},j={class:"list-unstyled mb-0"},U={class:"col-md-6"},z={class:"list-unstyled mb-0"},q={class:"text-center mt-4 d-flex gap-3 align-content-center justify-content-center"},H={key:1,class:"text-center mt-5"},K={__name:"ProductoDetalleView",setup(Q){const u=k(),y=E(),b=C(),s=I(null),c=I("");$(()=>{const e=JSON.parse(localStorage.getItem("ListaProductos")||"[]");s.value=e.find(t=>t.ID===y.params.id)});function N(e,t){if(!t)return e;const n=t.split(",").map(r=>r.trim());let a=0;for(const r of n){const[d,m]=r.split("+").map(S=>parseInt(S.trim()));if(isNaN(d)||isNaN(m)||d<=0||m<0)continue;const x=Math.floor(e/d)*m;x>a&&(a=x)}return e+a}const w=()=>{P.confirm("Â¿Eliminar producto?","Esta acciÃ³n no se puede deshacer.",()=>{const t=JSON.parse(localStorage.getItem("ListaProductos")||"[]").filter(n=>n.ID!==s.value.ID);localStorage.setItem("ListaProductos",JSON.stringify(t)),P.success("ðŸ—‘ï¸ Producto eliminado"),b.push("/Productos")},()=>{P.message("âŒ Cancelado")})},D=()=>{const e=parseInt(c.value);if(!e||e<1){u.error("âŒ Ingresa una cantidad vÃ¡lida antes de agregar.");return}const t=N(e,s.value.Promocion),n={...s.value,cantidad:e,unidadesEntregadas:t},a=JSON.parse(localStorage.getItem("carrito")||"[]"),r=a.findIndex(d=>d.ID===n.ID);r!==-1?(a[r].cantidad+=n.cantidad,a[r].unidadesEntregadas+=n.unidadesEntregadas,u.warning(`âš ï¸ Cantidad actualizada: "${n.NombreProducto}" x${a[r].cantidad} (entregados: ${a[r].unidadesEntregadas})`)):(a.push(n),u.success(`âœ… Producto agregado: "${n.NombreProducto}" x${n.cantidad} (entregados: ${n.unidadesEntregadas})`)),localStorage.setItem("carrito",JSON.stringify(a)),b.push("/Productos")};return(e,t)=>{const n=_("router-link"),a=_("RouterLink");return p(),g("div",L,[s.value?(p(),g("div",M,[o("div",O,[o("div",R,[o("div",F,[A(o("input",{type:"number",min:"1","onUpdate:modelValue":t[0]||(t[0]=r=>c.value=r),class:"form-control py-2 fs-1 text text-center",id:"cantidad",placeholder:"0"},null,512),[[J,c.value]])]),o("div",{class:"col-8"},[o("button",{class:"btn btn-lg btn-primary w-100 w-md-auto",onClick:D}," ðŸ›’ Agregar al carrito ")])]),o("h3",B," ðŸ§ª "+i(s.value.NombreProducto),1),o("div",G,[o("div",T,[o("ul",j,[o("li",null,[t[1]||(t[1]=o("strong",null,"ðŸ“¦ PresentaciÃ³n:",-1)),l(" "+i(s.value.Presentacion),1)]),o("li",null,[t[2]||(t[2]=o("strong",null,"ðŸ§¬ Principio Activo:",-1)),l(" "+i(s.value.PrincipioActivo),1)]),o("li",null,[t[3]||(t[3]=o("strong",null,"ðŸ·ï¸ Marca:",-1)),l(" "+i(s.value.Marca),1)]),o("li",null,[t[4]||(t[4]=o("strong",null,"ðŸ§¾ IVA:",-1)),l(" "+i(s.value.IVA>0?s.value.IVA+"%":"No aplica"),1)])])]),o("div",U,[o("ul",z,[o("li",null,[t[5]||(t[5]=o("strong",null,"ðŸ’Š Precio Farmacia:",-1)),l(" $"+i(s.value.PrecioFarmacia.toFixed(2)),1)]),o("li",null,[t[6]||(t[6]=o("strong",null,"ðŸ’° PVP:",-1)),l(" $"+i(s.value.PVP.toFixed(2)),1)]),o("li",null,[t[7]||(t[7]=o("strong",null,"ðŸŽ PromociÃ³n:",-1)),l(" "+i(s.value.Promocion||"Sin promociÃ³n"),1)]),o("li",null,[t[8]||(t[8]=o("strong",null,"ðŸ”» Descuento:",-1)),l(" "+i(s.value.Descuento)+"%",1)])])])]),t[11]||(t[11]=o("hr",{class:"my-4"},null,-1)),o("div",q,[o("button",{class:"btn btn-danger px-2 sm",onClick:w}," ðŸ—‘ï¸ Eliminar "),v(n,{class:"btn btn-info px-2 sm",to:"/editar/"+s.value.ID},{default:f(()=>[...t[9]||(t[9]=[l(" âœï¸ Editar ",-1)])]),_:1},8,["to"]),v(a,{class:"btn btn-warning px-2 sm",to:"/Productos"},{default:f(()=>[...t[10]||(t[10]=[l(" ðŸ”™ Regresar ",-1)])]),_:1})])])])):(p(),g("div",H,[t[13]||(t[13]=o("h4",{class:"text-danger"},"âŒ Producto no encontrado",-1)),v(a,{class:"btn btn-secondary mt-3",to:"/Productos"},{default:f(()=>[...t[12]||(t[12]=[l(" ðŸ”™ Volver al listado ",-1)])]),_:1})]))])}}},Y=V(K,[["__scopeId","data-v-fdf1d0af"]]);export{Y as default};
