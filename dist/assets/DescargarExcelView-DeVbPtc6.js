import{u as r,w as x}from"./xlsx-hAyDQTdp.js";import{F as _}from"./FileSaver.min-SHCrSFge.js";import{m as g,a as b,b as y,d as f,e as a,h,k as S,g as k}from"./index-DREQ0Xr5.js";const w={class:"container py-5"},E={class:"text-center d-flex gap-5"},N={__name:"DescargarExcelView",setup(D){const c=g(),l=()=>{const o=JSON.parse(localStorage.getItem("ListaProductos")||"[]");if(!o.length){c.error("âŒ No hay productos para exportar");return}const t=r.json_to_sheet(o),e=r.book_new();r.book_append_sheet(e,t,"Productos");const s=new Date,p=s.getFullYear(),i=String(s.getMonth()+1).padStart(2,"0"),d=String(s.getDate()).padStart(2,"0"),n=`productos_${p}-${i}-${d}DESCARGADOS_APP.xlsx`,u=x(e,{bookType:"xlsx",type:"array"}),m=new Blob([u],{type:"application/octet-stream"});_.saveAs(m,n),c.success(`âœ… Excel descargado como ${n}`)};return(o,t)=>{const e=b("RouterLink");return f(),y("div",w,[t[1]||(t[1]=a("h2",{class:"text-primary fw-bold mb-4 text-center"}," ðŸ“¥ Descargar Excel de productos ",-1)),a("div",E,[a("button",{class:"btn btn-success px-4 py-2",onClick:l}," ðŸ“ Descargar Excel "),h(e,{class:"btn btn-outline-warning",to:"/gestionar"},{default:S(()=>[...t[0]||(t[0]=[k("Regresar",-1)])]),_:1})])])}}};export{N as default};
