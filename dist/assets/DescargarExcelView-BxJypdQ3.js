import{u as r,w as x}from"./xlsx-hAyDQTdp.js";import{F as _}from"./FileSaver.min-D8LqL_Af.js";import{m as g,a as b,b as f,d as y,e as a,h,k,f as w}from"./index-CcTAiHa-.js";const S={class:"container py-5"},E={class:"text-center d-flex gap-5"},V={__name:"DescargarExcelView",setup(v){const c=g(),l=()=>{const o=JSON.parse(localStorage.getItem("ListaProductos")||"[]");if(!o.length){c.error("❌ No hay productos para exportar");return}const t=r.json_to_sheet(o),e=r.book_new();r.book_append_sheet(e,t,"Productos");const s=new Date,p=s.getFullYear(),i=String(s.getMonth()+1).padStart(2,"0"),d=String(s.getDate()).padStart(2,"0"),n=`productos_${p}-${i}-${d}.xlsx`,u=x(e,{bookType:"xlsx",type:"array"}),m=new Blob([u],{type:"application/octet-stream"});_.saveAs(m,n),c.success(`✅ Excel descargado como ${n}`)};return(o,t)=>{const e=b("RouterLink");return y(),f("div",S,[t[1]||(t[1]=a("h2",{class:"text-primary fw-bold mb-4 text-center"}," 📥 Descargar Excel de productos ",-1)),a("div",E,[a("button",{class:"btn btn-success px-4 py-2",onClick:l}," 📁 Descargar Excel "),h(e,{class:"btn btn-outline-warning",to:"/gestionar"},{default:k(()=>[...t[0]||(t[0]=[w("Regresar",-1)])]),_:1})])])}}};export{V as default};
