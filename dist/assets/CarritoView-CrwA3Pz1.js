import{_ as Rt,m as At,r as T,o as zt,y as Et,b as F,d as D,e as h,i as j,w as A,v as B,s as at,t as S,F as st,h as lt,z as O,k as M,x as Nt,p as Y}from"./index-C-4iUKpE.js";import{E as jt}from"./exceljs.min-C_UQIJcG.js";import{F as Bt}from"./FileSaver.min-DOMrB2vs.js";import{c as L,a as dt}from"./utility-CvRbycmg.js";import{E as Mt}from"./jspdf.es.min-C1pStIGI.js";function yt(e,t,n,r,o){r=r||{};var i=1.15,l=o.internal.scaleFactor,s=o.internal.getFontSize()/l,d=o.getLineHeightFactor?o.getLineHeightFactor():i,a=s*d,u=/\r\n|\r|\n/g,c="",v=1;if((r.valign==="middle"||r.valign==="bottom"||r.halign==="center"||r.halign==="right")&&(c=typeof e=="string"?e.split(u):e,v=c.length||1),n+=s*(2-i),r.valign==="middle"?n-=v/2*a:r.valign==="bottom"&&(n-=v*a),r.halign==="center"||r.halign==="right"){var p=s;if(r.halign==="center"&&(p*=.5),c&&v>=1){for(var m=0;m<c.length;m++)o.text(c[m],t-o.getStringUnitWidth(c[m])*p,n),n+=a;return o}t-=o.getStringUnitWidth(e)*p}return r.halign==="justify"?o.text(e,t,n,{maxWidth:r.maxWidth||100,align:"justify"}):o.text(e,t,n),o}var ut={},z=(function(){function e(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(t,n){n===void 0&&(n=null),n?n.__autoTableDocumentDefaults=t:ut=t},e.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},e.prototype.applyStyles=function(t,n){var r,o,i;n===void 0&&(n=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var l=this.jsPDFDocument.internal.getFont(),s=l.fontStyle,d=l.fontName;if(t.font&&(d=t.font),t.fontStyle){s=t.fontStyle;var a=this.getFontList()[d];a&&a.indexOf(s)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(a[0]),s=a[0])}if(this.jsPDFDocument.setFont(d,s),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!n){var u=e.unifyColor(t.fillColor);u&&(r=this.jsPDFDocument).setFillColor.apply(r,u),u=e.unifyColor(t.textColor),u&&(o=this.jsPDFDocument).setTextColor.apply(o,u),u=e.unifyColor(t.lineColor),u&&(i=this.jsPDFDocument).setDrawColor.apply(i,u),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(t,n,r){return this.jsPDFDocument.splitTextToSize(t,n,r)},e.prototype.rect=function(t,n,r,o,i){return this.jsPDFDocument.rect(t,n,r,o,i)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return ut||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e})(),et=function(e,t){return et=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},et(e,t)};function mt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");et(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var wt=(function(e){mt(t,e);function t(n){var r=e.call(this)||this;return r._element=n,r}return t})(Array);function Lt(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function It(e){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[e]}function U(e,t,n){n.applyStyles(t,!0);var r=Array.isArray(e)?e:[e],o=r.map(function(i){return n.getTextWidth(i)}).reduce(function(i,l){return Math.max(i,l)},0);return o}function bt(e,t,n,r){var o=t.settings.tableLineWidth,i=t.settings.tableLineColor;e.applyStyles({lineWidth:o,lineColor:i});var l=xt(o,!1);l&&e.rect(n.x,n.y,t.getWidth(e.pageSize().width),r.y-n.y,l)}function xt(e,t){var n=e>0,r=t||t===0;return n&&r?"DF":n?"S":r?"F":null}function J(e,t){var n,r,o,i;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=t}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(n=e.left)!==null&&n!==void 0?n:t,top:(r=e.top)!==null&&r!==void 0?r:t,right:(o=e.right)!==null&&o!==void 0?o:t,bottom:(i=e.bottom)!==null&&i!==void 0?i:t}):(typeof e!="number"&&(e=t),{top:e,right:e,bottom:e,left:e})}function St(e,t){var n=J(t.settings.margin,0);return e.pageSize().width-(n.left+n.right)}function $t(e,t,n,r,o){var i={},l=1.3333333333333333,s=Q(t,function(b){return o.getComputedStyle(b).backgroundColor});s!=null&&(i.fillColor=s);var d=Q(t,function(b){return o.getComputedStyle(b).color});d!=null&&(i.textColor=d);var a=Ot(r,n);a&&(i.cellPadding=a);var u="borderTopColor",c=l*n,v=r.borderTopWidth;if(r.borderBottomWidth===v&&r.borderRightWidth===v&&r.borderLeftWidth===v){var p=(parseFloat(v)||0)/c;p&&(i.lineWidth=p)}else i.lineWidth={top:(parseFloat(r.borderTopWidth)||0)/c,right:(parseFloat(r.borderRightWidth)||0)/c,bottom:(parseFloat(r.borderBottomWidth)||0)/c,left:(parseFloat(r.borderLeftWidth)||0)/c},i.lineWidth.top||(i.lineWidth.right?u="borderRightColor":i.lineWidth.bottom?u="borderBottomColor":i.lineWidth.left&&(u="borderLeftColor"));var m=Q(t,function(b){return o.getComputedStyle(b)[u]});m!=null&&(i.lineColor=m);var C=["left","right","center","justify"];C.indexOf(r.textAlign)!==-1&&(i.halign=r.textAlign),C=["middle","bottom","top"],C.indexOf(r.verticalAlign)!==-1&&(i.valign=r.verticalAlign);var x=parseInt(r.fontSize||"");isNaN(x)||(i.fontSize=x/l);var P=Vt(r);P&&(i.fontStyle=P);var W=(r.fontFamily||"").toLowerCase();return e.indexOf(W)!==-1&&(i.font=W),i}function Vt(e){var t="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(t="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(t+="italic"),t}function Q(e,t){var n=Pt(e,t);if(!n)return null;var r=n.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!r||!Array.isArray(r))return null;var o=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3])],i=parseInt(r[4]);return i===0||isNaN(o[0])||isNaN(o[1])||isNaN(o[2])?null:o}function Pt(e,t){var n=t(e);return n==="rgba(0, 0, 0, 0)"||n==="transparent"||n==="initial"||n==="inherit"?e.parentElement==null?null:Pt(e.parentElement,t):n}function Ot(e,t){var n=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],r=96/(72/t),o=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,i=n.map(function(s){return parseInt(s||"0")/r}),l=J(i,0);return o>l.top&&(l.top=o),o>l.bottom&&(l.bottom=o),l}function Ct(e,t,n,r,o){var i,l;r===void 0&&(r=!1),o===void 0&&(o=!1);var s;typeof t=="string"?s=n.document.querySelector(t):s=t;var d=Object.keys(e.getFontList()),a=e.scaleFactor(),u=[],c=[],v=[];if(!s)return console.error("Html table could not be found with input: ",t),{head:u,body:c,foot:v};for(var p=0;p<s.rows.length;p++){var m=s.rows[p],C=(l=(i=m?.parentElement)===null||i===void 0?void 0:i.tagName)===null||l===void 0?void 0:l.toLowerCase(),x=Yt(d,a,n,m,r,o);x&&(C==="thead"?u.push(x):C==="tfoot"?v.push(x):c.push(x))}return{head:u,body:c,foot:v}}function Yt(e,t,n,r,o,i){for(var l=new wt(r),s=0;s<r.cells.length;s++){var d=r.cells[s],a=n.getComputedStyle(d);if(o||a.display!=="none"){var u=void 0;i&&(u=$t(e,d,t,a,n)),l.push({rowSpan:d.rowSpan,colSpan:d.colSpan,styles:u,_element:d,content:Ut(d)})}}var c=n.getComputedStyle(r);if(l.length>0&&(o||c.display!=="none"))return l}function Ut(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(n){return n.trim()}).join(`
`),t.innerText||t.textContent||""}function Kt(e,t,n){for(var r=0,o=[e,t,n];r<o.length;r++){var i=o[r];i&&typeof i!="object"&&console.error("The options parameter should be of type object, is: "+typeof i),i.startY&&typeof i.startY!="number"&&(console.error("Invalid value for startY option",i.startY),delete i.startY)}}function _(e,t,n,r,o){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),l=1;l<arguments.length;l++){var s=arguments[l];if(s!=null)for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&(i[d]=s[d])}return i}function Ft(e,t){var n=new z(e),r=n.getDocumentOptions(),o=n.getGlobalOptions();Kt(o,r,t);var i=_({},o,r,t),l;typeof window<"u"&&(l=window);var s=Jt(o,r,t),d=qt(o,r,t),a=Gt(n,i),u=Xt(n,i,l);return{id:t.tableId,content:u,hooks:d,styles:s,settings:a}}function Jt(e,t,n){for(var r={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},o=function(d){if(d==="columnStyles"){var a=e[d],u=t[d],c=n[d];r.columnStyles=_({},a,u,c)}else{var v=[e,t,n],p=v.map(function(m){return m[d]||{}});r[d]=_({},p[0],p[1],p[2])}},i=0,l=Object.keys(r);i<l.length;i++){var s=l[i];o(s)}return r}function qt(e,t,n){for(var r=[e,t,n],o={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},i=0,l=r;i<l.length;i++){var s=l[i];s.didParseCell&&o.didParseCell.push(s.didParseCell),s.willDrawCell&&o.willDrawCell.push(s.willDrawCell),s.didDrawCell&&o.didDrawCell.push(s.didDrawCell),s.willDrawPage&&o.willDrawPage.push(s.willDrawPage),s.didDrawPage&&o.didDrawPage.push(s.didDrawPage)}return o}function Gt(e,t){var n,r,o,i,l,s,d,a,u,c,v,p,m=J(t.margin,40/e.scaleFactor()),C=(n=Qt(e,t.startY))!==null&&n!==void 0?n:m.top,x;t.showFoot===!0?x="everyPage":t.showFoot===!1?x="never":x=(r=t.showFoot)!==null&&r!==void 0?r:"everyPage";var P;t.showHead===!0?P="everyPage":t.showHead===!1?P="never":P=(o=t.showHead)!==null&&o!==void 0?o:"everyPage";var W=(i=t.useCss)!==null&&i!==void 0?i:!1,b=t.theme||(W?"plain":"striped"),g=!!t.horizontalPageBreak,f=(l=t.horizontalPageBreakRepeat)!==null&&l!==void 0?l:null;return{includeHiddenHtml:(s=t.includeHiddenHtml)!==null&&s!==void 0?s:!1,useCss:W,theme:b,startY:C,margin:m,pageBreak:(d=t.pageBreak)!==null&&d!==void 0?d:"auto",rowPageBreak:(a=t.rowPageBreak)!==null&&a!==void 0?a:"auto",tableWidth:(u=t.tableWidth)!==null&&u!==void 0?u:"auto",showHead:P,showFoot:x,tableLineWidth:(c=t.tableLineWidth)!==null&&c!==void 0?c:0,tableLineColor:(v=t.tableLineColor)!==null&&v!==void 0?v:200,horizontalPageBreak:g,horizontalPageBreakRepeat:f,horizontalPageBreakBehaviour:(p=t.horizontalPageBreakBehaviour)!==null&&p!==void 0?p:"afterAllRows"}}function Qt(e,t){var n=e.getLastAutoTable(),r=e.scaleFactor(),o=e.pageNumber(),i=!1;if(n&&n.startPageNumber){var l=n.startPageNumber+n.pageNumber-1;i=l===o}return typeof t=="number"?t:(t==null||t===!1)&&i&&n?.finalY!=null?n.finalY+20/r:null}function Xt(e,t,n){var r=t.head||[],o=t.body||[],i=t.foot||[];if(t.html){var l=t.includeHiddenHtml;if(n){var s=Ct(e,t.html,n,l,t.useCss)||{};r=s.head||r,o=s.body||r,i=s.foot||r}else console.error("Cannot parse html in non browser environment")}var d=t.columns||Zt(r,o,i);return{columns:d,head:r,body:o,foot:i}}function Zt(e,t,n){var r=e[0]||t[0]||n[0]||[],o=[];return Object.keys(r).filter(function(i){return i!=="_element"}).forEach(function(i){var l=1,s;Array.isArray(r)?s=r[parseInt(i)]:s=r[i],typeof s=="object"&&!Array.isArray(s)&&(l=s?.colSpan||1);for(var d=0;d<l;d++){var a=void 0;Array.isArray(r)?a=o.length:a=i+(d>0?"_".concat(d):"");var u={dataKey:a};o.push(u)}}),o}var rt=(function(){function e(t,n,r){this.table=n,this.pageNumber=n.pageNumber,this.settings=n.settings,this.cursor=r,this.doc=t.getDocument()}return e})(),te=(function(e){mt(t,e);function t(n,r,o,i,l,s){var d=e.call(this,n,r,s)||this;return d.cell=o,d.row=i,d.column=l,d.section=i.section,d}return t})(rt),ee=(function(){function e(t,n){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=n.columns,this.head=n.head,this.body=n.body,this.foot=n.foot}return e.prototype.getHeadHeight=function(t){return this.head.reduce(function(n,r){return n+r.getMaxCellHeight(t)},0)},e.prototype.getFootHeight=function(t){return this.foot.reduce(function(n,r){return n+r.getMaxCellHeight(t)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(t,n,r,o,i,l){for(var s=0,d=n;s<d.length;s++){var a=d[s],u=new te(t,this,r,o,i,l),c=a(u)===!1;if(r.text=Array.isArray(r.text)?r.text:[r.text],c)return!1}return!0},e.prototype.callEndPageHooks=function(t,n){t.applyStyles(t.userStyles);for(var r=0,o=this.hooks.didDrawPage;r<o.length;r++){var i=o[r];i(new rt(t,this,n))}},e.prototype.callWillDrawPageHooks=function(t,n){for(var r=0,o=this.hooks.willDrawPage;r<o.length;r++){var i=o[r];i(new rt(t,this,n))}},e.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var n=this.columns.reduce(function(o,i){return o+i.wrappedWidth},0);return n}else{var r=this.settings.margin;return t-r.left-r.right}},e})(),Dt=(function(){function e(t,n,r,o,i){i===void 0&&(i=!1),this.height=0,this.raw=t,t instanceof wt&&(this.raw=t._element,this.element=t._element),this.index=n,this.section=r,this.cells=o,this.spansMultiplePages=i}return e.prototype.getMaxCellHeight=function(t){var n=this;return t.reduce(function(r,o){var i;return Math.max(r,((i=n.cells[o.index])===null||i===void 0?void 0:i.height)||0)},0)},e.prototype.hasRowSpan=function(t){var n=this;return t.filter(function(r){var o=n.cells[r.index];return o?o.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(t,n){return this.getMaxCellHeight(n)<=t},e.prototype.getMinimumRowHeight=function(t,n){var r=this;return t.reduce(function(o,i){var l=r.cells[i.index];if(!l)return 0;var s=n.getLineHeight(l.styles.fontSize),d=l.padding("vertical"),a=d+s;return a>o?a:o},0)},e})(),Ht=(function(){function e(t,n,r){var o;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=n,this.section=r,this.raw=t;var i=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,i=(o=t.content)!==null&&o!==void 0?o:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var l=i!=null?""+i:"",s=/\r\n|\r|\n/g;this.text=l.split(s)}return e.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var n=this.height-this.padding("vertical");t=this.y+n/2+this.padding("top")}var r;if(this.styles.halign==="right")r=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var o=this.width-this.padding("horizontal");r=this.x+o/2+this.padding("left")}else r=this.x+this.padding("left");return{x:r,y:t}},e.prototype.getContentHeight=function(t,n){n===void 0&&(n=1.15);var r=Array.isArray(this.text)?this.text.length:1,o=this.styles.fontSize/t*n,i=r*o+this.padding("vertical");return Math.max(i,this.styles.minCellHeight)},e.prototype.padding=function(t){var n=J(this.styles.cellPadding,0);return t==="vertical"?n.top+n.bottom:t==="horizontal"?n.left+n.right:n[t]},e})(),re=(function(){function e(t,n,r){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=n,this.index=r}return e.prototype.getMaxCustomCellWidth=function(t){for(var n=0,r=0,o=t.allRows();r<o.length;r++){var i=o[r],l=i.cells[this.index];l&&typeof l.styles.cellWidth=="number"&&(n=Math.max(n,l.styles.cellWidth))}return n},e})();function ne(e,t){oe(e,t);var n=[],r=0;t.columns.forEach(function(i){var l=i.getMaxCustomCellWidth(t);l?i.width=l:(i.width=i.wrappedWidth,n.push(i)),r+=i.width});var o=t.getWidth(e.pageSize().width)-r;o&&(o=nt(n,o,function(i){return Math.max(i.minReadableWidth,i.minWidth)})),o&&(o=nt(n,o,function(i){return i.minWidth})),o=Math.abs(o),!t.settings.horizontalPageBreak&&o>.1/e.scaleFactor()&&(o=o<1?o:Math.round(o),console.warn("Of the table content, ".concat(o," units width could not fit page"))),ae(t),se(t,e),ie(t)}function oe(e,t){var n=e.scaleFactor(),r=t.settings.horizontalPageBreak,o=St(e,t);t.allRows().forEach(function(i){for(var l=0,s=t.columns;l<s.length;l++){var d=s[l],a=i.cells[d.index];if(a){var u=t.hooks.didParseCell;t.callCellHooks(e,u,a,i,d,null);var c=a.padding("horizontal");a.contentWidth=U(a.text,a.styles,e)+c;var v=U(a.text.join(" ").split(/[^\S\u00A0]+/),a.styles,e);if(a.minReadableWidth=v+a.padding("horizontal"),typeof a.styles.cellWidth=="number")a.minWidth=a.styles.cellWidth,a.wrappedWidth=a.styles.cellWidth;else if(a.styles.cellWidth==="wrap"||r===!0)a.contentWidth>o?(a.minWidth=o,a.wrappedWidth=o):(a.minWidth=a.contentWidth,a.wrappedWidth=a.contentWidth);else{var p=10/n;a.minWidth=a.styles.minCellWidth||p,a.wrappedWidth=a.contentWidth,a.minWidth>a.wrappedWidth&&(a.wrappedWidth=a.minWidth)}}}}),t.allRows().forEach(function(i){for(var l=0,s=t.columns;l<s.length;l++){var d=s[l],a=i.cells[d.index];if(a&&a.colSpan===1)d.wrappedWidth=Math.max(d.wrappedWidth,a.wrappedWidth),d.minWidth=Math.max(d.minWidth,a.minWidth),d.minReadableWidth=Math.max(d.minReadableWidth,a.minReadableWidth);else{var u=t.styles.columnStyles[d.dataKey]||t.styles.columnStyles[d.index]||{},c=u.cellWidth||u.minCellWidth;c&&typeof c=="number"&&(d.minWidth=c,d.wrappedWidth=c)}a&&(a.colSpan>1&&!d.minWidth&&(d.minWidth=a.minWidth),a.colSpan>1&&!d.wrappedWidth&&(d.wrappedWidth=a.minWidth))}})}function nt(e,t,n){for(var r=t,o=e.reduce(function(p,m){return p+m.wrappedWidth},0),i=0;i<e.length;i++){var l=e[i],s=l.wrappedWidth/o,d=r*s,a=l.width+d,u=n(l),c=a<u?u:a;t-=c-l.width,l.width=c}if(t=Math.round(t*1e10)/1e10,t){var v=e.filter(function(p){return t<0?p.width>n(p):!0});v.length&&(t=nt(v,t,n))}return t}function ie(e){for(var t={},n=1,r=e.allRows(),o=0;o<r.length;o++)for(var i=r[o],l=0,s=e.columns;l<s.length;l++){var d=s[l],a=t[d.index];if(n>1)n--,delete i.cells[d.index];else if(a)a.cell.height+=i.height,n=a.cell.colSpan,delete i.cells[d.index],a.left--,a.left<=1&&delete t[d.index];else{var u=i.cells[d.index];if(!u)continue;if(u.height=i.height,u.rowSpan>1){var c=r.length-o,v=u.rowSpan>c?c:u.rowSpan;t[d.index]={cell:u,left:v,row:i}}}}}function ae(e){for(var t=e.allRows(),n=0;n<t.length;n++)for(var r=t[n],o=null,i=0,l=0,s=0;s<e.columns.length;s++){var d=e.columns[s];if(l-=1,l>1&&e.columns[s+1])i+=d.width,delete r.cells[d.index];else if(o){var a=o;delete r.cells[d.index],o=null,a.width=d.width+i}else{var a=r.cells[d.index];if(!a)continue;if(l=a.colSpan,i=0,a.colSpan>1){o=a,i+=d.width;continue}a.width=d.width+i}}}function se(e,t){for(var n={count:0,height:0},r=0,o=e.allRows();r<o.length;r++){for(var i=o[r],l=0,s=e.columns;l<s.length;l++){var d=s[l],a=i.cells[d.index];if(a){t.applyStyles(a.styles,!0);var u=a.width-a.padding("horizontal");if(a.styles.overflow==="linebreak")a.text=t.splitTextToSize(a.text,u+1/t.scaleFactor(),{fontSize:a.styles.fontSize});else if(a.styles.overflow==="ellipsize")a.text=ht(a.text,u,a.styles,t,"...");else if(a.styles.overflow==="hidden")a.text=ht(a.text,u,a.styles,t,"");else if(typeof a.styles.overflow=="function"){var c=a.styles.overflow(a.text,u);typeof c=="string"?a.text=[c]:a.text=c}a.contentHeight=a.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var v=a.contentHeight/a.rowSpan;a.rowSpan>1&&n.count*n.height<v*a.rowSpan?n={height:v,count:a.rowSpan}:n&&n.count>0&&n.height>v&&(v=n.height),v>i.height&&(i.height=v)}}n.count--}}function ht(e,t,n,r,o){return e.map(function(i){return le(i,t,n,r,o)})}function le(e,t,n,r,o){var i=1e4*r.scaleFactor();if(t=Math.ceil(t*i)/i,t>=U(e,n,r))return e;for(;t<U(e+o,n,r)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+o}function Wt(e,t){var n=new z(e),r=de(t,n.scaleFactor()),o=new ee(t,r);return ne(n,o),n.applyStyles(n.userStyles),o}function de(e,t){var n=e.content,r=he(n.columns);if(n.head.length===0){var o=ft(r,"head");o&&n.head.push(o)}if(n.foot.length===0){var o=ft(r,"foot");o&&n.foot.push(o)}var i=e.settings.theme,l=e.styles;return{columns:r,head:X("head",n.head,r,l,i,t),body:X("body",n.body,r,l,i,t),foot:X("foot",n.foot,r,l,i,t)}}function X(e,t,n,r,o,i){var l={},s=t.map(function(d,a){for(var u=0,c={},v=0,p=0,m=0,C=n;m<C.length;m++){var x=C[m];if(l[x.index]==null||l[x.index].left===0)if(p===0){var P=void 0;Array.isArray(d)?P=d[x.index-v-u]:P=d[x.dataKey];var W={};typeof P=="object"&&!Array.isArray(P)&&(W=P?.styles||{});var b=fe(e,x,a,o,r,i,W),g=new Ht(P,b,e);c[x.dataKey]=g,c[x.index]=g,p=g.colSpan-1,l[x.index]={left:g.rowSpan-1,times:p}}else p--,v++;else l[x.index].left--,p=l[x.index].times,u++}return new Dt(d,a,e,c)});return s}function ft(e,t){var n={};return e.forEach(function(r){if(r.raw!=null){var o=ue(t,r.raw);o!=null&&(n[r.dataKey]=o)}}),Object.keys(n).length>0?n:null}function ue(e,t){if(e==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(e==="foot"&&typeof t=="object")return t.footer;return null}function he(e){return e.map(function(t,n){var r,o;return typeof t=="object"?o=(r=t.dataKey)!==null&&r!==void 0?r:n:o=n,new re(o,t,n)})}function fe(e,t,n,r,o,i,l){var s=It(r),d;e==="head"?d=o.headStyles:e==="body"?d=o.bodyStyles:e==="foot"&&(d=o.footStyles);var a=_({},s.table,s[e],o.styles,d),u=o.columnStyles[t.dataKey]||o.columnStyles[t.index]||{},c=e==="body"?u:{},v=e==="body"&&n%2===0?_({},s.alternateRow,o.alternateRowStyles):{},p=Lt(i),m=_({},p,a,v,c);return _(m,l)}function ge(e,t,n){var r;n===void 0&&(n={});var o=St(e,t),i=new Map,l=[],s=[],d=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?d=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(d=[t.settings.horizontalPageBreakRepeat]),d.forEach(function(v){var p=t.columns.find(function(m){return m.dataKey===v||m.index===v});p&&!i.has(p.index)&&(i.set(p.index,!0),l.push(p.index),s.push(t.columns[p.index]),o-=p.wrappedWidth)});for(var a=!0,u=(r=n?.start)!==null&&r!==void 0?r:0;u<t.columns.length;){if(i.has(u)){u++;continue}var c=t.columns[u].wrappedWidth;if(a||o>=c)a=!1,l.push(u),s.push(t.columns[u]),o-=c;else break;u++}return{colIndexes:l,columns:s,lastIndex:u-1}}function ce(e,t){for(var n=[],r=0;r<t.columns.length;r++){var o=ge(e,t,{start:r});o.columns.length&&(n.push(o),r=o.lastIndex)}return n}function kt(e,t){var n=t.settings,r=n.startY,o=n.margin,i={x:o.left,y:r},l=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),s=r+o.bottom+l;if(n.pageBreak==="avoid"){var d=t.body,a=d.reduce(function(v,p){return v+p.height},0);s+=a}var u=new z(e);(n.pageBreak==="always"||n.startY!=null&&s>u.pageSize().height)&&(_t(u),i.y=o.top),t.callWillDrawPageHooks(u,i);var c=_({},i);t.startPageNumber=u.pageNumber(),n.horizontalPageBreak?ve(u,t,c,i):(u.applyStyles(u.userStyles),(n.showHead==="firstPage"||n.showHead==="everyPage")&&t.head.forEach(function(v){return R(u,t,v,i,t.columns)}),u.applyStyles(u.userStyles),t.body.forEach(function(v,p){var m=p===t.body.length-1;K(u,t,v,m,c,i,t.columns)}),u.applyStyles(u.userStyles),(n.showFoot==="lastPage"||n.showFoot==="everyPage")&&t.foot.forEach(function(v){return R(u,t,v,i,t.columns)})),bt(u,t,c,i),t.callEndPageHooks(u,i),t.finalY=i.y,e.lastAutoTable=t,u.applyStyles(u.userStyles)}function ve(e,t,n,r){var o=ce(e,t),i=t.settings;if(i.horizontalPageBreakBehaviour==="afterAllRows")o.forEach(function(a,u){e.applyStyles(e.userStyles),u>0?I(e,t,n,r,a.columns,!0):gt(e,t,r,a.columns),pe(e,t,n,r,a.columns),Z(e,t,r,a.columns)});else for(var l=-1,s=o[0],d=function(){var a=l;if(s){e.applyStyles(e.userStyles);var u=s.columns;l>=0?I(e,t,n,r,u,!0):gt(e,t,r,u),a=ct(e,t,l+1,r,u),Z(e,t,r,u)}var c=a-l;o.slice(1).forEach(function(v){e.applyStyles(e.userStyles),I(e,t,n,r,v.columns,!0),ct(e,t,l+1,r,v.columns,c),Z(e,t,r,v.columns)}),l=a};l<t.body.length-1;)d()}function gt(e,t,n,r){var o=t.settings;e.applyStyles(e.userStyles),(o.showHead==="firstPage"||o.showHead==="everyPage")&&t.head.forEach(function(i){return R(e,t,i,n,r)})}function pe(e,t,n,r,o){e.applyStyles(e.userStyles),t.body.forEach(function(i,l){var s=l===t.body.length-1;K(e,t,i,s,n,r,o)})}function ct(e,t,n,r,o,i){e.applyStyles(e.userStyles),i=i??t.body.length;var l=Math.min(n+i,t.body.length),s=-1;return t.body.slice(n,l).forEach(function(d,a){var u=n+a===t.body.length-1,c=Tt(e,t,u,r);d.canEntireRowFit(c,o)&&(R(e,t,d,r,o),s=n+a)}),s}function Z(e,t,n,r){var o=t.settings;e.applyStyles(e.userStyles),(o.showFoot==="lastPage"||o.showFoot==="everyPage")&&t.foot.forEach(function(i){return R(e,t,i,n,r)})}function ye(e,t,n){var r=n.getLineHeight(e.styles.fontSize),o=e.padding("vertical"),i=Math.floor((t-o)/r);return Math.max(0,i)}function me(e,t,n,r){var o={};e.spansMultiplePages=!0,e.height=0;for(var i=0,l=0,s=n.columns;l<s.length;l++){var d=s[l],a=e.cells[d.index];if(a){Array.isArray(a.text)||(a.text=[a.text]);var u=new Ht(a.raw,a.styles,a.section);u=_(u,a),u.text=[];var c=ye(a,t,r);a.text.length>c&&(u.text=a.text.splice(c,a.text.length));var v=r.scaleFactor(),p=r.getLineHeightFactor();a.contentHeight=a.getContentHeight(v,p),a.contentHeight>=t&&(a.contentHeight=t,u.styles.minCellHeight-=t),a.contentHeight>e.height&&(e.height=a.contentHeight),u.contentHeight=u.getContentHeight(v,p),u.contentHeight>i&&(i=u.contentHeight),o[d.index]=u}}var m=new Dt(e.raw,-1,e.section,o,!0);m.height=i;for(var C=0,x=n.columns;C<x.length;C++){var d=x[C],u=m.cells[d.index];u&&(u.height=m.height);var a=e.cells[d.index];a&&(a.height=e.height)}return m}function we(e,t,n,r){var o=e.pageSize().height,i=r.settings.margin,l=i.top+i.bottom,s=o-l;t.section==="body"&&(s-=r.getHeadHeight(r.columns)+r.getFootHeight(r.columns));var d=t.getMinimumRowHeight(r.columns,e),a=d<n;if(d>s)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!a)return!1;var u=t.hasRowSpan(r.columns),c=t.getMaxCellHeight(r.columns)>s;return c?(u&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(u||r.settings.rowPageBreak==="avoid")}function K(e,t,n,r,o,i,l){var s=Tt(e,t,r,i);if(n.canEntireRowFit(s,l))R(e,t,n,i,l);else if(we(e,n,s,t)){var d=me(n,s,t,e);R(e,t,n,i,l),I(e,t,o,i,l),K(e,t,d,r,o,i,l)}else I(e,t,o,i,l),K(e,t,n,r,o,i,l)}function R(e,t,n,r,o){r.x=t.settings.margin.left;for(var i=0,l=o;i<l.length;i++){var s=l[i],d=n.cells[s.index];if(!d){r.x+=s.width;continue}e.applyStyles(d.styles),d.x=r.x,d.y=r.y;var a=t.callCellHooks(e,t.hooks.willDrawCell,d,n,s,r);if(a===!1){r.x+=s.width;continue}be(e,d,r);var u=d.getTextPos();yt(d.text,u.x,u.y,{halign:d.styles.halign,valign:d.styles.valign,maxWidth:Math.ceil(d.width-d.padding("left")-d.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,d,n,s,r),r.x+=s.width}r.y+=n.height}function be(e,t,n){var r=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof r.lineWidth=="number"){var o=xt(r.lineWidth,r.fillColor);o&&e.rect(t.x,n.y,t.width,t.height,o)}else typeof r.lineWidth=="object"&&(r.fillColor&&e.rect(t.x,n.y,t.width,t.height,"F"),xe(e,t,n,r.lineWidth))}function xe(e,t,n,r){var o,i,l,s;r.top&&(o=n.x,i=n.y,l=n.x+t.width,s=n.y,r.right&&(l+=.5*r.right),r.left&&(o-=.5*r.left),d(r.top,o,i,l,s)),r.bottom&&(o=n.x,i=n.y+t.height,l=n.x+t.width,s=n.y+t.height,r.right&&(l+=.5*r.right),r.left&&(o-=.5*r.left),d(r.bottom,o,i,l,s)),r.left&&(o=n.x,i=n.y,l=n.x,s=n.y+t.height,r.top&&(i-=.5*r.top),r.bottom&&(s+=.5*r.bottom),d(r.left,o,i,l,s)),r.right&&(o=n.x+t.width,i=n.y,l=n.x+t.width,s=n.y+t.height,r.top&&(i-=.5*r.top),r.bottom&&(s+=.5*r.bottom),d(r.right,o,i,l,s));function d(a,u,c,v,p){e.getDocument().setLineWidth(a),e.getDocument().line(u,c,v,p,"S")}}function Tt(e,t,n,r){var o=t.settings.margin.bottom,i=t.settings.showFoot;return(i==="everyPage"||i==="lastPage"&&n)&&(o+=t.getFootHeight(t.columns)),e.pageSize().height-r.y-o}function I(e,t,n,r,o,i){o===void 0&&(o=[]),i===void 0&&(i=!1),e.applyStyles(e.userStyles),t.settings.showFoot==="everyPage"&&!i&&t.foot.forEach(function(s){return R(e,t,s,r,o)}),t.callEndPageHooks(e,r);var l=t.settings.margin;bt(e,t,n,r),_t(e),t.pageNumber++,r.x=l.left,r.y=l.top,n.y=l.top,t.callWillDrawPageHooks(e,r),t.settings.showHead==="everyPage"&&(t.head.forEach(function(s){return R(e,t,s,r,o)}),e.applyStyles(e.userStyles))}function _t(e){var t=e.pageNumber();e.setPage(t+1);var n=e.pageNumber();return n===t?(e.addPage(),!0):!1}function Se(e){e.API.autoTable=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=t[0],o=Ft(this,r),i=Wt(this,o);return kt(this,i),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(t,n,r,o){yt(t,n,r,o,this)},e.API.autoTableSetDefaults=function(t){return z.setDefaults(t,this),this},e.autoTableSetDefaults=function(t,n){z.setDefaults(t,n)},e.API.autoTableHtmlToJson=function(t,n){var r;if(n===void 0&&(n=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var o=new z(this),i=Ct(o,t,window,n,!1),l=i.head,s=i.body,d=((r=l[0])===null||r===void 0?void 0:r.map(function(a){return a.content}))||[];return{columns:d,rows:s,data:s}}}var tt;function Pe(e,t){var n=Ft(e,t),r=Wt(e,n);kt(e,r)}try{if(typeof window<"u"&&window){var vt=window,pt=vt.jsPDF||((tt=vt.jspdf)===null||tt===void 0?void 0:tt.jsPDF);pt&&Se(pt)}}catch(e){console.error("Could not apply autoTable plugin",e)}const Ce={class:"container px-0"},Fe={key:0,class:"row mb-4"},De={class:"col-md-3"},He={class:"col-md-3"},We={class:"col-md-3"},ke={class:"col-md-3"},Te={class:"col-md-3"},_e={key:1,class:"mt-4 d-flex justify-content-around flex-wrap gap-4"},Re=["disabled"],Ae=["disabled"],ze={key:2,class:"mt-4"},Ee={key:0,class:"export-overlay"},Ne={key:1,class:"mt-4"},je={class:"row justify-content-end"},Be={class:"col-md-4"},Me={class:"list-group"},Le={class:"list-group-item d-flex justify-content-between"},Ie={class:"list-group-item d-flex justify-content-between"},$e={class:"list-group-item d-flex justify-content-between"},Ve={class:"list-group-item d-flex justify-content-between bg-light"},Oe={class:"fw-bold text-success"},Ye={key:2,class:"table-container",style:{"margin-bottom":"20px"}},Ue={class:"table table-bordered table-sm table-striped text-center align-middle tableProductos mx-auto"},Ke={"data-label":"Nombre"},Je={"data-label":"Presentaci√≥n"},qe={"data-label":"Principio Activo"},Ge={"data-label":"Precio Farmacia"},Qe={"data-label":"Promoci√≥n"},Xe={"data-label":"Descuento"},Ze={"data-label":"Marca"},tr={"data-label":"IVA"},er={"data-label":"Cantidad"},rr=["onUpdate:modelValue","onChange"],nr={"data-label":"Cantidad a recibir"},or={"data-label":"Precio total producto"},ir={"data-label":"Acciones"},ar=["onClick"],sr={key:3,class:"mobile-cards",style:{"margin-bottom":"20px"}},lr={class:"card-body"},dr={class:"d-flex justify-content-between align-items-start mb-2"},ur={class:"product-info"},hr={class:"card-title mb-1"},fr={class:"text-muted small"},gr={class:"price-info"},cr={class:"fw-bold text-success fs-5"},vr={class:"text-muted small"},pr={class:"mb-1"},yr={class:"badge bg-info text-dark ms-1"},mr={key:0},wr={class:"badge bg-warning text-dark ms-1"},br={class:"quantity-controls p-2 rounded bg-light"},xr={class:"d-flex align-items-center justify-content-between flex-wrap gap-2"},Sr={class:"d-flex align-items-center"},Pr=["onUpdate:modelValue","onChange"],Cr={class:"ms-2"},Fr={class:"badge bg-success"},Dr={class:"quantity-controls p-2 rounded bg-light mt-2"},Hr={class:"ms-2"},Wr={class:"d-grid mt-3"},kr=["onClick"],Tr={key:3,class:"alert alert-info mt-4"},_r={__name:"CarritoView",setup(e){const t=At(),n=T(0),r=T([]),o=T(0),i=T(!1),l=T(!1),s=T({Nombre:"",Ciudad:"",Fecha:"",Vendedor:""}),d=T(0),a=T(0),u=T(0),c=()=>{d.value=0,a.value=0,u.value=0,r.value.forEach(b=>{const g=b.PrecioFarmacia*b.cantidad,f=Number(b.IVA);f>0?(d.value+=g,u.value+=g*(f/100)):a.value+=g}),o.value=d.value+a.value+u.value};zt(()=>{const b=JSON.parse(localStorage.getItem("carrito"))||[];r.value=b,v(),c(),s.value.Fecha=new Date().toISOString().split("T")[0];const g=window.matchMedia("(max-width: 767px)"),f=y=>{i.value=y.matches!==void 0?y.matches:g.matches};f(g);try{g.addEventListener("change",f)}catch{g.addListener(f)}Et(()=>{try{g.removeEventListener("change",f)}catch{g.removeListener(f)}})});const v=()=>{o.value=r.value.reduce((b,g)=>{const f=g.IVA>0?g.IVA:0,y=g.PrecioFarmacia*g.cantidad*(1+f/100);return b+y},0)},p=(b,g,f)=>{r.value[b].cantidad<1&&(r.value[b].cantidad=1),localStorage.setItem("carrito",JSON.stringify(r.value)),v(),c(),n.value=L(g,f).total},m=b=>{try{Y.confirm("Confirmar eliminaci√≥n","¬øDesea eliminar este producto del carrito?",function(){r.value.splice(b,1),localStorage.setItem("carrito",JSON.stringify(r.value)),v(),c(),t.success("Producto eliminado")},function(){})}catch{r.value.splice(b,1),localStorage.setItem("carrito",JSON.stringify(r.value)),v(),c()}},C=async()=>{const g=["Nombre","Ciudad","Fecha","Vendedor","Tipo"].filter(f=>!s.value[f]);if(g.length){Y.alert(`‚ùå Faltan campos obligatorios: ${g.join(", ")}`);return}l.value=!0;try{const f=new jt.Workbook,y=f.addWorksheet(s.value.Tipo);y.addRow([`Datos ${s.value.Tipo}`]),y.addRow(["Nombre",s.value.Nombre]),y.addRow(["Ciudad",s.value.Ciudad]),y.addRow(["Fecha",s.value.Fecha]),y.addRow(["Vendedor",s.value.Vendedor]),y.addRow(["Tipo",s.value.Tipo]),y.addRow([]);let H=[],$=[];s.value.Tipo==="Pedido"&&(H=["Cantidad","Promoci√≥n","Nombre Producto","Lote","Fecha de Vencimiento"],$=r.value.map(w=>{const{promo:k,total:N,detalle:ot,cantidad:it}=L(w.cantidad,w.Promocion);return[w.cantidad,k,w.NombreProducto,"",""]})),s.value.Tipo==="Proforma"&&(H=["Cantidad","Promoci√≥n","Nombre Producto","Marca","Precio Farmacia","Total"],$=r.value.map(w=>{const k=w.PrecioFarmacia*w.cantidad;return[w.cantidad,L(w.cantidad,w.Promocion).promo,w.NombreProducto,w.Marca,w.PrecioFarmacia,k.toFixed(2)]}));const E=y.addRow(H);if(E.height=30,E.eachCell(w=>{w.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFCCE5FF"}},w.font={bold:!0,size:12,color:{argb:"FF000000"}},w.alignment={horizontal:"center",vertical:"middle",wrapText:!0},w.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}}}),s.value.Tipo==="Pedido"&&(y.getColumn(1).width=15,y.getColumn(2).width=15,y.getColumn(3).width=35,y.getColumn(4).width=40,y.getColumn(5).width=40),s.value.Tipo==="Proforma"&&(y.getColumn(1).width=15,y.getColumn(2).width=15,y.getColumn(3).width=35,y.getColumn(4).width=35,y.getColumn(5).width=15,y.getColumn(6).width=20),$.forEach(w=>{const k=y.addRow(w);k.height=55,k.eachCell(N=>{N.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},N.alignment={vertical:"middle",horizontal:"center",wrapText:!0}})}),s.value.Tipo==="Proforma"){y.addRow([]);const w=y.addRow(["","","","","Subtotal 15%:",`$ ${d.value.toFixed(2)}`]),k=y.addRow(["","","","","Subtotal 0%:",`$ ${a.value.toFixed(2)}`]),N=y.addRow(["","","","","IVA 15%:",`$ ${u.value.toFixed(2)}`]),ot=y.addRow(["","","","","VALOR TOTAL:",`$ ${o.value.toFixed(2)}`]);[w,k,N,ot].forEach(it=>{it.eachCell(V=>{V.value?.toString().trim()&&(V.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},V.alignment={vertical:"middle",horizontal:"center",wrapText:!0},V.font={bold:!0})})})}const q=await f.xlsx.writeBuffer(),G=`${s.value.Tipo}_Cliente_${s.value.Nombre}_ciudad_${s.value.Ciudad}_Cliente_${s.value.Fecha}.xlsx`;Bt.saveAs(new Blob([q]),G),t.success("Excel generado correctamente")}catch(f){console.error("Error generando Excel:",f),t.error("Ocurri√≥ un error al generar el Excel")}finally{l.value=!1}},x=async()=>{try{Y.confirm("Vaciar carrito","¬øEst√° seguro que desea vaciar todo el carrito? Esta acci√≥n no se puede deshacer.",function(){localStorage.removeItem("carrito"),r.value=[],v(),c(),t.success("Carrito vaciado")},function(){})}catch{localStorage.removeItem("carrito"),r.value=[]}},P=async()=>{if(!s.value.Nombre.trim()){Y.alert("Campo obligatorio","‚ùå Por favor, ingrese el nombre del cliente antes de exportar");return}l.value=!0;try{const b=new Date().toISOString().split("T")[0],g=s.value.Nombre.trim().replace(/\s+/g,"_"),f=new Mt({orientation:"portrait",unit:"pt",format:"a4"}),y=f.internal.pageSize.getWidth();let H=f.internal.pageSize.getHeight();const E=await W("/logo_mh.png");f.addImage(E,"PNG",40,20,60,60),f.setFontSize(14),f.text("Lista Productos MH",y/2,40,{align:"center"}),f.setFontSize(11),f.text(`Cliente: ${s.value.Nombre}`,y/2,60,{align:"center"}),f.text(`Fecha: ${b}`,y/2,80,{align:"center"});const q=[{header:"Producto",dataKey:"producto"},{header:"Marca",dataKey:"marca"},{header:"Presentaci√≥n",dataKey:"presentacion"},{header:"Precio",dataKey:"precio"},{header:"Promoci√≥n",dataKey:"promo"},{header:"Descuento %",dataKey:"descuento"}],G=r.value.map(w=>({producto:w.NombreProducto||"",marca:w.Marca||"",presentacion:w.Presentacion||"",precio:w.PrecioFarmacia!=null?"$"+Number(w.PrecioFarmacia).toFixed(2):"N/D",promo:w.Promocion||"",descuento:w.Descuento&&!isNaN(Number(w.Descuento))?w.Descuento+" %":""}));Pe(f,{startY:110,head:[q.map(w=>w.header)],body:G.map(w=>Object.values(w)),theme:"grid",headStyles:{fillColor:[21,28,166],textColor:"#fff",fontSize:10},bodyStyles:{fontSize:9},styles:{cellPadding:3,halign:"center",valign:"middle"},columnStyles:{0:{halign:"left"}},didDrawPage:w=>{const k=f.internal.getNumberOfPages();f.setFontSize(10),f.text(`P√°gina ${k}`,y-50,H-20,{align:"right"}),f.addImage(E,"PNG",40,20,60,60),f.setFontSize(14),f.text("Lista Productos MH",y/2,40,{align:"center"})}}),f.save(`Lista_MH_${g}_${b}.pdf`),t.success("PDF generado correctamente")}catch(b){console.error(b),t.error("Error al generar PDF")}finally{l.value=!1}};function W(b){return new Promise(g=>{const f=new Image;f.src=b,f.onload=()=>g(f)})}return(b,g)=>(D(),F("div",Ce,[g[28]||(g[28]=h("h2",{class:"text-center mb-4"},"üõí Carrito de Compras",-1)),r.value.length?(D(),F("div",Fe,[h("div",De,[g[5]||(g[5]=h("label",{class:"form-label"},"Nombre cliente",-1)),A(h("input",{"onUpdate:modelValue":g[0]||(g[0]=f=>s.value.Nombre=f),type:"text",class:"form-control"},null,512),[[B,s.value.Nombre]])]),h("div",He,[g[6]||(g[6]=h("label",{class:"form-label"},"Ciudad",-1)),A(h("input",{"onUpdate:modelValue":g[1]||(g[1]=f=>s.value.Ciudad=f),type:"text",class:"form-control"},null,512),[[B,s.value.Ciudad]])]),h("div",We,[g[7]||(g[7]=h("label",{class:"form-label"},"Fecha",-1)),A(h("input",{"onUpdate:modelValue":g[2]||(g[2]=f=>s.value.Fecha=f),type:"date",readonly:"",disabled:"",class:"form-control"},null,512),[[B,s.value.Fecha]])]),h("div",ke,[g[9]||(g[9]=h("label",{class:"form-label"},"Vendedor",-1)),A(h("select",{"onUpdate:modelValue":g[3]||(g[3]=f=>s.value.Vendedor=f),class:"form-select"},[...g[8]||(g[8]=[h("option",{value:"",disabled:"",selected:""},"Seleccione",-1),h("option",{value:"Diana Benalc√°zar"},"Diana Benalc√°zar",-1)])],512),[[at,s.value.Vendedor]])]),h("div",Te,[g[11]||(g[11]=h("label",{class:"form-label"},"Tipo de documento",-1)),A(h("select",{"onUpdate:modelValue":g[4]||(g[4]=f=>s.value.Tipo=f),class:"form-select"},[...g[10]||(g[10]=[h("option",{value:"",disabled:"",selected:""},"Seleccione",-1),h("option",{value:"Pedido"},"Pedido",-1),h("option",{value:"Proforma"},"Proforma",-1)])],512),[[at,s.value.Tipo]])])])):j("",!0),g[29]||(g[29]=h("hr",{style:{border:"solid 1px silver"}},null,-1)),r.value.length?(D(),F("div",_e,[h("button",{onClick:x,class:"btn btn-warning"}," Vaciar carrito "),h("button",{class:"btn btn-primary",onClick:C,disabled:!r.value.length}," Exportar Excel ",8,Re),h("button",{class:"btn btn-success",onClick:P,disabled:!r.value.length}," Exportar PDF ",8,Ae)])):j("",!0),g[30]||(g[30]=h("hr",{style:{border:"solid 1px silver"}},null,-1)),r.value.length?(D(),F("div",ze,[l.value?(D(),F("div",Ee,[...g[12]||(g[12]=[h("div",{class:"export-spinner","aria-hidden":"true"},null,-1),h("div",{class:"export-text"},"Generando archivo, por favor espere...",-1)])])):j("",!0),r.value.length?(D(),F("div",Ne,[h("div",je,[h("div",Be,[h("ul",Me,[h("li",Le,[g[13]||(g[13]=h("strong",null,"Subtotal 15%:",-1)),h("span",null,"$ "+S(d.value.toFixed(2)),1)]),h("li",Ie,[g[14]||(g[14]=h("strong",null,"Subtotal 0%:",-1)),h("span",null,"$ "+S(a.value.toFixed(2)),1)]),h("li",$e,[g[15]||(g[15]=h("strong",null,"IVA 15%:",-1)),h("span",null,"$ "+S(u.value.toFixed(2)),1)]),h("li",Ve,[g[16]||(g[16]=h("strong",null,"Total:",-1)),h("span",Oe,"$ "+S(o.value.toFixed(2)),1)])])])])])):j("",!0),g[27]||(g[27]=h("hr",{style:{border:"solid 1px silver"}},null,-1)),i.value?(D(),F("div",sr,[(D(!0),F(st,null,lt(r.value,(f,y)=>(D(),F("div",{key:f.id,class:"card mb-3 mobile-card"},[h("div",lr,[h("div",dr,[h("div",ur,[h("h5",hr,S(f.NombreProducto),1),h("div",fr,[h("div",null,[g[18]||(g[18]=h("strong",null,"Marca:",-1)),M(" "+S(f.Marca),1)]),h("div",null,[g[19]||(g[19]=h("strong",null,"Presentaci√≥n:",-1)),M(" "+S(f.Presentacion),1)]),h("div",null,[g[20]||(g[20]=h("strong",null,"P. Activo:",-1)),M(" "+S(f.PrincipioActivo||"-"),1)])])]),h("div",gr,[h("div",cr," $ "+S(Number(f.PrecioFarmacia).toFixed(2)),1),h("div",vr," IVA: "+S(f.IVA>0?f.IVA+"%":"No aplica"),1)])]),h("div",{class:Nt(["promo-info p-2 mb-2 rounded",f.Promocion?"bg-light":""])},[h("div",pr,[g[21]||(g[21]=h("strong",{class:"text-primary"},"Promoci√≥n:",-1)),h("span",yr,S(f.Promocion||"Sin promoci√≥n"),1)]),f.Descuento&&Number(f.Descuento)!==0?(D(),F("div",mr,[g[22]||(g[22]=h("strong",{class:"text-primary"},"Descuento:",-1)),h("span",wr,S(f.Descuento)+"%",1)])):j("",!0)],2),h("div",br,[h("div",xr,[h("div",Sr,[g[23]||(g[23]=h("label",{class:"me-2 fw-bold mb-0"},"Cantidad:",-1)),A(h("input",{type:"number",min:"0","onUpdate:modelValue":H=>f.cantidad=H,onChange:H=>p(y,f.cantidad,f.Promocion),class:"form-control",style:{width:"80px"}},null,40,Pr),[[B,f.cantidad,void 0,{number:!0}]])]),h("div",Cr,[g[24]||(g[24]=h("strong",null,"A recibir: ",-1)),h("span",Fr,S(O(L)(f.cantidad,f.Promocion).total),1)])])]),h("div",Dr,[h("div",Hr,[g[25]||(g[25]=h("strong",null,"Precio total: ",-1)),M(" $ "+S(O(dt)(f.cantidad,f.PrecioFarmacia).toFixed(2)),1)])]),h("div",Wr,[h("button",{class:"btn btn-outline-danger",onClick:H=>m(y)},[...g[26]||(g[26]=[h("i",{class:"fas fa-trash-alt me-2"},null,-1),M("Eliminar producto ",-1)])],8,kr)])])]))),128))])):(D(),F("div",Ye,[h("table",Ue,[g[17]||(g[17]=h("thead",null,[h("tr",null,[h("th",{class:"text-wrap fs-6 text"},"Nombre"),h("th",{class:"text-wrap fs-6 text"},"Presentaci√≥n"),h("th",{class:"text-wrap fs-6 text"},"Principio Activo"),h("th",{class:"text-wrap fs-6 text"},"P FARMACIA"),h("th",{class:"text-wrap fs-6 text"},"Promoci√≥n"),h("th",{class:"text-wrap fs-6 text"},"Descuento"),h("th",{class:"text-wrap fs-6 text"},"Marca"),h("th",{class:"text-wrap fs-6 text"},"IVA"),h("th",{class:"text-wrap fs-6 text"},"Cantidad"),h("th",{class:"text-wrap fs-6 text"},"A recibir"),h("th",{class:"text-wrap fs-6 text"},"Precio total producto"),h("th",{class:"text-wrap fs-6 text"},"Acciones")])],-1)),h("tbody",null,[(D(!0),F(st,null,lt(r.value,(f,y)=>(D(),F("tr",{key:f.id},[h("td",Ke,S(f.NombreProducto),1),h("td",Je,S(f.Presentacion),1),h("td",qe,S(f.PrincipioActivo),1),h("td",Ge,"$ "+S(f.PrecioFarmacia),1),h("td",Qe,S(f.Promocion),1),h("td",Xe,S(f.Descuento!==void 0&&f.Descuento!==null&&Number(f.Descuento)!==0?f.Descuento:""),1),h("td",Ze,S(f.Marca),1),h("td",tr,S(f.IVA>0?f.IVA+"%":"No aplica"),1),h("td",er,[A(h("input",{type:"number",min:"0","onUpdate:modelValue":H=>f.cantidad=H,onChange:H=>p(y,f.cantidad,f.Promocion),class:"form-control form-control-sm",style:{width:"80px"}},null,40,rr),[[B,f.cantidad,void 0,{number:!0}]])]),h("td",nr,S(O(L)(f.cantidad,f.Promocion).total),1),h("td",or," $ "+S(O(dt)(f.cantidad,f.PrecioFarmacia).toFixed(2)),1),h("td",ir,[h("button",{class:"btn btn-danger btn-sm",onClick:H=>m(y)}," Eliminar ",8,ar)])]))),128))])])]))])):(D(),F("div",Tr,"El carrito est√° vac√≠o."))]))}},Br=Rt(_r,[["__scopeId","data-v-e9d754c7"]]);export{Br as default};
