import{_ as k,m as w,u as N,c as D,n as S,r as f,o as V,a as _,b as i,d as u,e as o,w as E,v as $,t as r,f as n,h as m,k as g,p as A}from"./index-CcTAiHa-.js";import{c as C}from"./utility-BAyQKch2.js";const R={class:"container mt-5"},J={key:0,class:"card border-0 shadow-sm"},L={class:"card-body"},O={key:0},F={key:1,class:"row g-3 align-items-center mb-4"},M={class:"col-4"},T={class:"text-primary fw-bold mb-4"},B={class:"row g-3"},G={class:"col-md-6"},j={class:"list-unstyled mb-0"},q={class:"col-md-6"},z={class:"list-unstyled mb-0"},U={key:2},Y={class:"text-center mt-4 d-flex gap-3 align-content-center justify-content-center"},h={key:3},H={class:"text-center mt-4 d-flex gap-3 align-content-center justify-content-center"},K={key:1,class:"text-center mt-5"},Q={__name:"ProductoDetalleView",setup(W){const c=w(),p=N(),P=D(()=>p.query.modo||"ver"),b=S(),s=f(null),v=f("");V(()=>{const l=JSON.parse(localStorage.getItem("ListaProductos")||"[]");s.value=l.find(t=>t.ID===p.params.id)});const x=()=>{A.confirm("¿Eliminar producto?","Esta acción no se puede deshacer.",()=>{const t=JSON.parse(localStorage.getItem("ListaProductos")||"[]").filter(e=>e.ID!==s.value.ID);localStorage.setItem("ListaProductos",JSON.stringify(t)),c.success("🗑️ Producto eliminado"),b.push("/Productos")},()=>{c.message("❌ Cancelado")})},y=()=>{const l=parseInt(v.value);if(!l||l<1){c.error("❌ Ingresa una cantidad válida antes de agregar.");return}const t=C(l,s.value.Promocion).total,e={...s.value,cantidad:l,unidadesEntregadas:t},a=JSON.parse(localStorage.getItem("carrito")||"[]"),d=a.findIndex(I=>I.ID===e.ID);d!==-1?(a[d].cantidad+=e.cantidad,a[d].unidadesEntregadas+=e.unidadesEntregadas,c.warning(`⚠️ Cantidad actualizada: "${e.NombreProducto}" x${a[d].cantidad} (entregados: ${a[d].unidadesEntregadas})`)):(a.push(e),c.success(`✅ Producto agregado: "${e.NombreProducto}" x${e.cantidad} (entregados: ${e.unidadesEntregadas})`)),localStorage.setItem("carrito",JSON.stringify(a)),b.push("/Productos")};return(l,t)=>{const e=_("router-link"),a=_("RouterLink");return u(),i("div",R,[s.value?(u(),i("div",J,[o("div",L,[P.value==="gestionar"?(u(),i("div",O)):(u(),i("div",F,[o("div",M,[E(o("input",{type:"number",min:"1","onUpdate:modelValue":t[0]||(t[0]=d=>v.value=d),class:"form-control py-2 fs-1 text text-center",id:"cantidad",placeholder:"0"},null,512),[[$,v.value]])]),o("div",{class:"col-8"},[o("button",{class:"btn btn-lg btn-primary w-100 w-md-auto",onClick:y}," 🛒 Agregar al carrito ")])])),o("h3",T," 🧪 "+r(s.value.NombreProducto),1),o("div",B,[o("div",G,[o("ul",j,[o("li",null,[t[1]||(t[1]=o("strong",null,"📦 Presentación:",-1)),n(" "+r(s.value.Presentacion),1)]),o("li",null,[t[2]||(t[2]=o("strong",null,"🧬 Principio Activo:",-1)),n(" "+r(s.value.PrincipioActivo),1)]),o("li",null,[t[3]||(t[3]=o("strong",null,"🏷️ Marca:",-1)),n(" "+r(s.value.Marca),1)]),o("li",null,[t[4]||(t[4]=o("strong",null,"🧾 IVA:",-1)),n(" "+r(s.value.IVA>0?s.value.IVA+"%":"No aplica"),1)])])]),o("div",q,[o("ul",z,[o("li",null,[t[5]||(t[5]=o("strong",null,"💊 Precio Farmacia:",-1)),n(" $"+r(s.value.PrecioFarmacia.toFixed(2)),1)]),o("li",null,[t[6]||(t[6]=o("strong",null,"💰 PVP:",-1)),n(" $"+r(s.value.PVP.toFixed(2)),1)]),o("li",null,[t[7]||(t[7]=o("strong",null,"🎁 Promoción:",-1)),n(" "+r(s.value.Promocion||"Sin promoción"),1)]),o("li",null,[t[8]||(t[8]=o("strong",null,"🔻 Descuento:",-1)),n(" "+r(s.value.Descuento)+"%",1)])])])]),t[12]||(t[12]=o("hr",{class:"my-4"},null,-1)),P.value==="gestionar"?(u(),i("div",U,[o("div",Y,[o("button",{class:"btn btn-danger px-2 sm",onClick:x}," 🗑️ Eliminar "),m(e,{class:"btn btn-info px-2 sm",to:"/editar/"+s.value.ID},{default:g(()=>[...t[9]||(t[9]=[n(" ✏️ Editar ",-1)])]),_:1},8,["to"]),m(a,{class:"btn btn-warning px-2 sm",to:"/Productos"},{default:g(()=>[...t[10]||(t[10]=[n(" 🔙 Regresar ",-1)])]),_:1})])])):(u(),i("div",h,[o("div",H,[m(a,{class:"btn btn-warning px-2 sm",to:"/Productos"},{default:g(()=>[...t[11]||(t[11]=[n(" 🔙 Regresar ",-1)])]),_:1})])]))])])):(u(),i("div",K,[t[14]||(t[14]=o("h4",{class:"text-danger"},"❌ Producto no encontrado",-1)),m(a,{class:"btn btn-secondary mt-3",to:"/Productos"},{default:g(()=>[...t[13]||(t[13]=[n(" 🔙 Volver al listado ",-1)])]),_:1})]))])}}},tt=k(Q,[["__scopeId","data-v-7172d6bd"]]);export{tt as default};
