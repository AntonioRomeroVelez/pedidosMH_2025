import{_ as _t,m as Rt,r as H,o as At,y as zt,b as F,d as D,e as f,i as E,w as R,v as N,s as ot,t as S,F as rt,h as it,z as I,k as j,x as Et,p as U}from"./index-B95D08oq.js";import{E as Nt}from"./exceljs.min-Dx1XQ5tT.js";import{F as jt}from"./FileSaver.min-wIh-7gHe.js";import{E as Bt}from"./jspdf.es.min-lJxk9_fL.js";import{c as B,a as at}from"./utility-CvRbycmg.js";function ct(e,t,o,n,r){n=n||{};var i=1.15,l=r.internal.scaleFactor,d=r.internal.getFontSize()/l,s=r.getLineHeightFactor?r.getLineHeightFactor():i,a=d*s,h=/\r\n|\r|\n/g,c="",v=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(c=typeof e=="string"?e.split(h):e,v=c.length||1),o+=d*(2-i),n.valign==="middle"?o-=v/2*a:n.valign==="bottom"&&(o-=v*a),n.halign==="center"||n.halign==="right"){var p=d;if(n.halign==="center"&&(p*=.5),c&&v>=1){for(var y=0;y<c.length;y++)r.text(c[y],t-r.getStringUnitWidth(c[y])*p,o),o+=a;return r}t-=r.getStringUnitWidth(e)*p}return n.halign==="justify"?r.text(e,t,o,{maxWidth:n.maxWidth||100,align:"justify"}):r.text(e,t,o),r}var st={},A=(function(){function e(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(t,o){o===void 0&&(o=null),o?o.__autoTableDocumentDefaults=t:st=t},e.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},e.prototype.applyStyles=function(t,o){var n,r,i;o===void 0&&(o=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var l=this.jsPDFDocument.internal.getFont(),d=l.fontStyle,s=l.fontName;if(t.font&&(s=t.font),t.fontStyle){d=t.fontStyle;var a=this.getFontList()[s];a&&a.indexOf(d)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(a[0]),d=a[0])}if(this.jsPDFDocument.setFont(s,d),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!o){var h=e.unifyColor(t.fillColor);h&&(n=this.jsPDFDocument).setFillColor.apply(n,h),h=e.unifyColor(t.textColor),h&&(r=this.jsPDFDocument).setTextColor.apply(r,h),h=e.unifyColor(t.lineColor),h&&(i=this.jsPDFDocument).setDrawColor.apply(i,h),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(t,o,n){return this.jsPDFDocument.splitTextToSize(t,o,n)},e.prototype.rect=function(t,o,n,r,i){return this.jsPDFDocument.rect(t,o,n,r,i)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return st||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e})(),Q=function(e,t){return Q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,n){o.__proto__=n}||function(o,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(o[r]=n[r])},Q(e,t)};function vt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Q(e,t);function o(){this.constructor=e}e.prototype=t===null?Object.create(t):(o.prototype=t.prototype,new o)}var pt=(function(e){vt(t,e);function t(o){var n=e.call(this)||this;return n._element=o,n}return t})(Array);function Mt(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function Lt(e){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[e]}function $(e,t,o){o.applyStyles(t,!0);var n=Array.isArray(e)?e:[e],r=n.map(function(i){return o.getTextWidth(i)}).reduce(function(i,l){return Math.max(i,l)},0);return r}function yt(e,t,o,n){var r=t.settings.tableLineWidth,i=t.settings.tableLineColor;e.applyStyles({lineWidth:r,lineColor:i});var l=mt(r,!1);l&&e.rect(o.x,o.y,t.getWidth(e.pageSize().width),n.y-o.y,l)}function mt(e,t){var o=e>0,n=t||t===0;return o&&n?"DF":o?"S":n?"F":null}function O(e,t){var o,n,r,i;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=t}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(o=e.left)!==null&&o!==void 0?o:t,top:(n=e.top)!==null&&n!==void 0?n:t,right:(r=e.right)!==null&&r!==void 0?r:t,bottom:(i=e.bottom)!==null&&i!==void 0?i:t}):(typeof e!="number"&&(e=t),{top:e,right:e,bottom:e,left:e})}function wt(e,t){var o=O(t.settings.margin,0);return e.pageSize().width-(o.left+o.right)}function It(e,t,o,n,r){var i={},l=1.3333333333333333,d=J(t,function(u){return r.getComputedStyle(u).backgroundColor});d!=null&&(i.fillColor=d);var s=J(t,function(u){return r.getComputedStyle(u).color});s!=null&&(i.textColor=s);var a=Vt(n,o);a&&(i.cellPadding=a);var h="borderTopColor",c=l*o,v=n.borderTopWidth;if(n.borderBottomWidth===v&&n.borderRightWidth===v&&n.borderLeftWidth===v){var p=(parseFloat(v)||0)/c;p&&(i.lineWidth=p)}else i.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/c,right:(parseFloat(n.borderRightWidth)||0)/c,bottom:(parseFloat(n.borderBottomWidth)||0)/c,left:(parseFloat(n.borderLeftWidth)||0)/c},i.lineWidth.top||(i.lineWidth.right?h="borderRightColor":i.lineWidth.bottom?h="borderBottomColor":i.lineWidth.left&&(h="borderLeftColor"));var y=J(t,function(u){return r.getComputedStyle(u)[h]});y!=null&&(i.lineColor=y);var w=["left","right","center","justify"];w.indexOf(n.textAlign)!==-1&&(i.halign=n.textAlign),w=["middle","bottom","top"],w.indexOf(n.verticalAlign)!==-1&&(i.valign=n.verticalAlign);var b=parseInt(n.fontSize||"");isNaN(b)||(i.fontSize=b/l);var C=$t(n);C&&(i.fontStyle=C);var x=(n.fontFamily||"").toLowerCase();return e.indexOf(x)!==-1&&(i.font=x),i}function $t(e){var t="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(t="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(t+="italic"),t}function J(e,t){var o=bt(e,t);if(!o)return null;var n=o.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var r=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],i=parseInt(n[4]);return i===0||isNaN(r[0])||isNaN(r[1])||isNaN(r[2])?null:r}function bt(e,t){var o=t(e);return o==="rgba(0, 0, 0, 0)"||o==="transparent"||o==="initial"||o==="inherit"?e.parentElement==null?null:bt(e.parentElement,t):o}function Vt(e,t){var o=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],n=96/(72/t),r=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,i=o.map(function(d){return parseInt(d||"0")/n}),l=O(i,0);return r>l.top&&(l.top=r),r>l.bottom&&(l.bottom=r),l}function xt(e,t,o,n,r){var i,l;n===void 0&&(n=!1),r===void 0&&(r=!1);var d;typeof t=="string"?d=o.document.querySelector(t):d=t;var s=Object.keys(e.getFontList()),a=e.scaleFactor(),h=[],c=[],v=[];if(!d)return console.error("Html table could not be found with input: ",t),{head:h,body:c,foot:v};for(var p=0;p<d.rows.length;p++){var y=d.rows[p],w=(l=(i=y?.parentElement)===null||i===void 0?void 0:i.tagName)===null||l===void 0?void 0:l.toLowerCase(),b=Ot(s,a,o,y,n,r);b&&(w==="thead"?h.push(b):w==="tfoot"?v.push(b):c.push(b))}return{head:h,body:c,foot:v}}function Ot(e,t,o,n,r,i){for(var l=new pt(n),d=0;d<n.cells.length;d++){var s=n.cells[d],a=o.getComputedStyle(s);if(r||a.display!=="none"){var h=void 0;i&&(h=It(e,s,t,a,o)),l.push({rowSpan:s.rowSpan,colSpan:s.colSpan,styles:h,_element:s,content:Yt(s)})}}var c=o.getComputedStyle(n);if(l.length>0&&(r||c.display!=="none"))return l}function Yt(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(o){return o.trim()}).join(`
`),t.innerText||t.textContent||""}function Ut(e,t,o){for(var n=0,r=[e,t,o];n<r.length;n++){var i=r[n];i&&typeof i!="object"&&console.error("The options parameter should be of type object, is: "+typeof i),i.startY&&typeof i.startY!="number"&&(console.error("Invalid value for startY option",i.startY),delete i.startY)}}function k(e,t,o,n,r){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),l=1;l<arguments.length;l++){var d=arguments[l];if(d!=null)for(var s in d)Object.prototype.hasOwnProperty.call(d,s)&&(i[s]=d[s])}return i}function St(e,t){var o=new A(e),n=o.getDocumentOptions(),r=o.getGlobalOptions();Ut(r,n,t);var i=k({},r,n,t),l;typeof window<"u"&&(l=window);var d=Jt(r,n,t),s=Kt(r,n,t),a=qt(o,i),h=Qt(o,i,l);return{id:t.tableId,content:h,hooks:s,styles:d,settings:a}}function Jt(e,t,o){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},r=function(s){if(s==="columnStyles"){var a=e[s],h=t[s],c=o[s];n.columnStyles=k({},a,h,c)}else{var v=[e,t,o],p=v.map(function(y){return y[s]||{}});n[s]=k({},p[0],p[1],p[2])}},i=0,l=Object.keys(n);i<l.length;i++){var d=l[i];r(d)}return n}function Kt(e,t,o){for(var n=[e,t,o],r={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},i=0,l=n;i<l.length;i++){var d=l[i];d.didParseCell&&r.didParseCell.push(d.didParseCell),d.willDrawCell&&r.willDrawCell.push(d.willDrawCell),d.didDrawCell&&r.didDrawCell.push(d.didDrawCell),d.willDrawPage&&r.willDrawPage.push(d.willDrawPage),d.didDrawPage&&r.didDrawPage.push(d.didDrawPage)}return r}function qt(e,t){var o,n,r,i,l,d,s,a,h,c,v,p,y=O(t.margin,40/e.scaleFactor()),w=(o=Gt(e,t.startY))!==null&&o!==void 0?o:y.top,b;t.showFoot===!0?b="everyPage":t.showFoot===!1?b="never":b=(n=t.showFoot)!==null&&n!==void 0?n:"everyPage";var C;t.showHead===!0?C="everyPage":t.showHead===!1?C="never":C=(r=t.showHead)!==null&&r!==void 0?r:"everyPage";var x=(i=t.useCss)!==null&&i!==void 0?i:!1,u=t.theme||(x?"plain":"striped"),g=!!t.horizontalPageBreak,m=(l=t.horizontalPageBreakRepeat)!==null&&l!==void 0?l:null;return{includeHiddenHtml:(d=t.includeHiddenHtml)!==null&&d!==void 0?d:!1,useCss:x,theme:u,startY:w,margin:y,pageBreak:(s=t.pageBreak)!==null&&s!==void 0?s:"auto",rowPageBreak:(a=t.rowPageBreak)!==null&&a!==void 0?a:"auto",tableWidth:(h=t.tableWidth)!==null&&h!==void 0?h:"auto",showHead:C,showFoot:b,tableLineWidth:(c=t.tableLineWidth)!==null&&c!==void 0?c:0,tableLineColor:(v=t.tableLineColor)!==null&&v!==void 0?v:200,horizontalPageBreak:g,horizontalPageBreakRepeat:m,horizontalPageBreakBehaviour:(p=t.horizontalPageBreakBehaviour)!==null&&p!==void 0?p:"afterAllRows"}}function Gt(e,t){var o=e.getLastAutoTable(),n=e.scaleFactor(),r=e.pageNumber(),i=!1;if(o&&o.startPageNumber){var l=o.startPageNumber+o.pageNumber-1;i=l===r}return typeof t=="number"?t:(t==null||t===!1)&&i&&o?.finalY!=null?o.finalY+20/n:null}function Qt(e,t,o){var n=t.head||[],r=t.body||[],i=t.foot||[];if(t.html){var l=t.includeHiddenHtml;if(o){var d=xt(e,t.html,o,l,t.useCss)||{};n=d.head||n,r=d.body||n,i=d.foot||n}else console.error("Cannot parse html in non browser environment")}var s=t.columns||Xt(n,r,i);return{columns:s,head:n,body:r,foot:i}}function Xt(e,t,o){var n=e[0]||t[0]||o[0]||[],r=[];return Object.keys(n).filter(function(i){return i!=="_element"}).forEach(function(i){var l=1,d;Array.isArray(n)?d=n[parseInt(i)]:d=n[i],typeof d=="object"&&!Array.isArray(d)&&(l=d?.colSpan||1);for(var s=0;s<l;s++){var a=void 0;Array.isArray(n)?a=r.length:a=i+(s>0?"_".concat(s):"");var h={dataKey:a};r.push(h)}}),r}var X=(function(){function e(t,o,n){this.table=o,this.pageNumber=o.pageNumber,this.settings=o.settings,this.cursor=n,this.doc=t.getDocument()}return e})(),Zt=(function(e){vt(t,e);function t(o,n,r,i,l,d){var s=e.call(this,o,n,d)||this;return s.cell=r,s.row=i,s.column=l,s.section=i.section,s}return t})(X),te=(function(){function e(t,o){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=o.columns,this.head=o.head,this.body=o.body,this.foot=o.foot}return e.prototype.getHeadHeight=function(t){return this.head.reduce(function(o,n){return o+n.getMaxCellHeight(t)},0)},e.prototype.getFootHeight=function(t){return this.foot.reduce(function(o,n){return o+n.getMaxCellHeight(t)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(t,o,n,r,i,l){for(var d=0,s=o;d<s.length;d++){var a=s[d],h=new Zt(t,this,n,r,i,l),c=a(h)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],c)return!1}return!0},e.prototype.callEndPageHooks=function(t,o){t.applyStyles(t.userStyles);for(var n=0,r=this.hooks.didDrawPage;n<r.length;n++){var i=r[n];i(new X(t,this,o))}},e.prototype.callWillDrawPageHooks=function(t,o){for(var n=0,r=this.hooks.willDrawPage;n<r.length;n++){var i=r[n];i(new X(t,this,o))}},e.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var o=this.columns.reduce(function(r,i){return r+i.wrappedWidth},0);return o}else{var n=this.settings.margin;return t-n.left-n.right}},e})(),Pt=(function(){function e(t,o,n,r,i){i===void 0&&(i=!1),this.height=0,this.raw=t,t instanceof pt&&(this.raw=t._element,this.element=t._element),this.index=o,this.section=n,this.cells=r,this.spansMultiplePages=i}return e.prototype.getMaxCellHeight=function(t){var o=this;return t.reduce(function(n,r){var i;return Math.max(n,((i=o.cells[r.index])===null||i===void 0?void 0:i.height)||0)},0)},e.prototype.hasRowSpan=function(t){var o=this;return t.filter(function(n){var r=o.cells[n.index];return r?r.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(t,o){return this.getMaxCellHeight(o)<=t},e.prototype.getMinimumRowHeight=function(t,o){var n=this;return t.reduce(function(r,i){var l=n.cells[i.index];if(!l)return 0;var d=o.getLineHeight(l.styles.fontSize),s=l.padding("vertical"),a=s+d;return a>r?a:r},0)},e})(),Ct=(function(){function e(t,o,n){var r;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=o,this.section=n,this.raw=t;var i=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,i=(r=t.content)!==null&&r!==void 0?r:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var l=i!=null?""+i:"",d=/\r\n|\r|\n/g;this.text=l.split(d)}return e.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var o=this.height-this.padding("vertical");t=this.y+o/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var r=this.width-this.padding("horizontal");n=this.x+r/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:t}},e.prototype.getContentHeight=function(t,o){o===void 0&&(o=1.15);var n=Array.isArray(this.text)?this.text.length:1,r=this.styles.fontSize/t*o,i=n*r+this.padding("vertical");return Math.max(i,this.styles.minCellHeight)},e.prototype.padding=function(t){var o=O(this.styles.cellPadding,0);return t==="vertical"?o.top+o.bottom:t==="horizontal"?o.left+o.right:o[t]},e})(),ee=(function(){function e(t,o,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=o,this.index=n}return e.prototype.getMaxCustomCellWidth=function(t){for(var o=0,n=0,r=t.allRows();n<r.length;n++){var i=r[n],l=i.cells[this.index];l&&typeof l.styles.cellWidth=="number"&&(o=Math.max(o,l.styles.cellWidth))}return o},e})();function ne(e,t){oe(e,t);var o=[],n=0;t.columns.forEach(function(i){var l=i.getMaxCustomCellWidth(t);l?i.width=l:(i.width=i.wrappedWidth,o.push(i)),n+=i.width});var r=t.getWidth(e.pageSize().width)-n;r&&(r=Z(o,r,function(i){return Math.max(i.minReadableWidth,i.minWidth)})),r&&(r=Z(o,r,function(i){return i.minWidth})),r=Math.abs(r),!t.settings.horizontalPageBreak&&r>.1/e.scaleFactor()&&(r=r<1?r:Math.round(r),console.warn("Of the table content, ".concat(r," units width could not fit page"))),ie(t),ae(t,e),re(t)}function oe(e,t){var o=e.scaleFactor(),n=t.settings.horizontalPageBreak,r=wt(e,t);t.allRows().forEach(function(i){for(var l=0,d=t.columns;l<d.length;l++){var s=d[l],a=i.cells[s.index];if(a){var h=t.hooks.didParseCell;t.callCellHooks(e,h,a,i,s,null);var c=a.padding("horizontal");a.contentWidth=$(a.text,a.styles,e)+c;var v=$(a.text.join(" ").split(/[^\S\u00A0]+/),a.styles,e);if(a.minReadableWidth=v+a.padding("horizontal"),typeof a.styles.cellWidth=="number")a.minWidth=a.styles.cellWidth,a.wrappedWidth=a.styles.cellWidth;else if(a.styles.cellWidth==="wrap"||n===!0)a.contentWidth>r?(a.minWidth=r,a.wrappedWidth=r):(a.minWidth=a.contentWidth,a.wrappedWidth=a.contentWidth);else{var p=10/o;a.minWidth=a.styles.minCellWidth||p,a.wrappedWidth=a.contentWidth,a.minWidth>a.wrappedWidth&&(a.wrappedWidth=a.minWidth)}}}}),t.allRows().forEach(function(i){for(var l=0,d=t.columns;l<d.length;l++){var s=d[l],a=i.cells[s.index];if(a&&a.colSpan===1)s.wrappedWidth=Math.max(s.wrappedWidth,a.wrappedWidth),s.minWidth=Math.max(s.minWidth,a.minWidth),s.minReadableWidth=Math.max(s.minReadableWidth,a.minReadableWidth);else{var h=t.styles.columnStyles[s.dataKey]||t.styles.columnStyles[s.index]||{},c=h.cellWidth||h.minCellWidth;c&&typeof c=="number"&&(s.minWidth=c,s.wrappedWidth=c)}a&&(a.colSpan>1&&!s.minWidth&&(s.minWidth=a.minWidth),a.colSpan>1&&!s.wrappedWidth&&(s.wrappedWidth=a.minWidth))}})}function Z(e,t,o){for(var n=t,r=e.reduce(function(p,y){return p+y.wrappedWidth},0),i=0;i<e.length;i++){var l=e[i],d=l.wrappedWidth/r,s=n*d,a=l.width+s,h=o(l),c=a<h?h:a;t-=c-l.width,l.width=c}if(t=Math.round(t*1e10)/1e10,t){var v=e.filter(function(p){return t<0?p.width>o(p):!0});v.length&&(t=Z(v,t,o))}return t}function re(e){for(var t={},o=1,n=e.allRows(),r=0;r<n.length;r++)for(var i=n[r],l=0,d=e.columns;l<d.length;l++){var s=d[l],a=t[s.index];if(o>1)o--,delete i.cells[s.index];else if(a)a.cell.height+=i.height,o=a.cell.colSpan,delete i.cells[s.index],a.left--,a.left<=1&&delete t[s.index];else{var h=i.cells[s.index];if(!h)continue;if(h.height=i.height,h.rowSpan>1){var c=n.length-r,v=h.rowSpan>c?c:h.rowSpan;t[s.index]={cell:h,left:v,row:i}}}}}function ie(e){for(var t=e.allRows(),o=0;o<t.length;o++)for(var n=t[o],r=null,i=0,l=0,d=0;d<e.columns.length;d++){var s=e.columns[d];if(l-=1,l>1&&e.columns[d+1])i+=s.width,delete n.cells[s.index];else if(r){var a=r;delete n.cells[s.index],r=null,a.width=s.width+i}else{var a=n.cells[s.index];if(!a)continue;if(l=a.colSpan,i=0,a.colSpan>1){r=a,i+=s.width;continue}a.width=s.width+i}}}function ae(e,t){for(var o={count:0,height:0},n=0,r=e.allRows();n<r.length;n++){for(var i=r[n],l=0,d=e.columns;l<d.length;l++){var s=d[l],a=i.cells[s.index];if(a){t.applyStyles(a.styles,!0);var h=a.width-a.padding("horizontal");if(a.styles.overflow==="linebreak")a.text=t.splitTextToSize(a.text,h+1/t.scaleFactor(),{fontSize:a.styles.fontSize});else if(a.styles.overflow==="ellipsize")a.text=lt(a.text,h,a.styles,t,"...");else if(a.styles.overflow==="hidden")a.text=lt(a.text,h,a.styles,t,"");else if(typeof a.styles.overflow=="function"){var c=a.styles.overflow(a.text,h);typeof c=="string"?a.text=[c]:a.text=c}a.contentHeight=a.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var v=a.contentHeight/a.rowSpan;a.rowSpan>1&&o.count*o.height<v*a.rowSpan?o={height:v,count:a.rowSpan}:o&&o.count>0&&o.height>v&&(v=o.height),v>i.height&&(i.height=v)}}o.count--}}function lt(e,t,o,n,r){return e.map(function(i){return se(i,t,o,n,r)})}function se(e,t,o,n,r){var i=1e4*n.scaleFactor();if(t=Math.ceil(t*i)/i,t>=$(e,o,n))return e;for(;t<$(e+r,o,n)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+r}function Ft(e,t){var o=new A(e),n=le(t,o.scaleFactor()),r=new te(t,n);return ne(o,r),o.applyStyles(o.userStyles),r}function le(e,t){var o=e.content,n=he(o.columns);if(o.head.length===0){var r=dt(n,"head");r&&o.head.push(r)}if(o.foot.length===0){var r=dt(n,"foot");r&&o.foot.push(r)}var i=e.settings.theme,l=e.styles;return{columns:n,head:K("head",o.head,n,l,i,t),body:K("body",o.body,n,l,i,t),foot:K("foot",o.foot,n,l,i,t)}}function K(e,t,o,n,r,i){var l={},d=t.map(function(s,a){for(var h=0,c={},v=0,p=0,y=0,w=o;y<w.length;y++){var b=w[y];if(l[b.index]==null||l[b.index].left===0)if(p===0){var C=void 0;Array.isArray(s)?C=s[b.index-v-h]:C=s[b.dataKey];var x={};typeof C=="object"&&!Array.isArray(C)&&(x=C?.styles||{});var u=fe(e,b,a,r,n,i,x),g=new Ct(C,u,e);c[b.dataKey]=g,c[b.index]=g,p=g.colSpan-1,l[b.index]={left:g.rowSpan-1,times:p}}else p--,v++;else l[b.index].left--,p=l[b.index].times,h++}return new Pt(s,a,e,c)});return d}function dt(e,t){var o={};return e.forEach(function(n){if(n.raw!=null){var r=de(t,n.raw);r!=null&&(o[n.dataKey]=r)}}),Object.keys(o).length>0?o:null}function de(e,t){if(e==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(e==="foot"&&typeof t=="object")return t.footer;return null}function he(e){return e.map(function(t,o){var n,r;return typeof t=="object"?r=(n=t.dataKey)!==null&&n!==void 0?n:o:r=o,new ee(r,t,o)})}function fe(e,t,o,n,r,i,l){var d=Lt(n),s;e==="head"?s=r.headStyles:e==="body"?s=r.bodyStyles:e==="foot"&&(s=r.footStyles);var a=k({},d.table,d[e],r.styles,s),h=r.columnStyles[t.dataKey]||r.columnStyles[t.index]||{},c=e==="body"?h:{},v=e==="body"&&o%2===0?k({},d.alternateRow,r.alternateRowStyles):{},p=Mt(i),y=k({},p,a,v,c);return k(y,l)}function ue(e,t,o){var n;o===void 0&&(o={});var r=wt(e,t),i=new Map,l=[],d=[],s=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?s=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(s=[t.settings.horizontalPageBreakRepeat]),s.forEach(function(v){var p=t.columns.find(function(y){return y.dataKey===v||y.index===v});p&&!i.has(p.index)&&(i.set(p.index,!0),l.push(p.index),d.push(t.columns[p.index]),r-=p.wrappedWidth)});for(var a=!0,h=(n=o?.start)!==null&&n!==void 0?n:0;h<t.columns.length;){if(i.has(h)){h++;continue}var c=t.columns[h].wrappedWidth;if(a||r>=c)a=!1,l.push(h),d.push(t.columns[h]),r-=c;else break;h++}return{colIndexes:l,columns:d,lastIndex:h-1}}function ge(e,t){for(var o=[],n=0;n<t.columns.length;n++){var r=ue(e,t,{start:n});r.columns.length&&(o.push(r),n=r.lastIndex)}return o}function Dt(e,t){var o=t.settings,n=o.startY,r=o.margin,i={x:r.left,y:n},l=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),d=n+r.bottom+l;if(o.pageBreak==="avoid"){var s=t.body,a=s.reduce(function(v,p){return v+p.height},0);d+=a}var h=new A(e);(o.pageBreak==="always"||o.startY!=null&&d>h.pageSize().height)&&(Ht(h),i.y=r.top),t.callWillDrawPageHooks(h,i);var c=k({},i);t.startPageNumber=h.pageNumber(),o.horizontalPageBreak?ce(h,t,c,i):(h.applyStyles(h.userStyles),(o.showHead==="firstPage"||o.showHead==="everyPage")&&t.head.forEach(function(v){return T(h,t,v,i,t.columns)}),h.applyStyles(h.userStyles),t.body.forEach(function(v,p){var y=p===t.body.length-1;V(h,t,v,y,c,i,t.columns)}),h.applyStyles(h.userStyles),(o.showFoot==="lastPage"||o.showFoot==="everyPage")&&t.foot.forEach(function(v){return T(h,t,v,i,t.columns)})),yt(h,t,c,i),t.callEndPageHooks(h,i),t.finalY=i.y,e.lastAutoTable=t,h.applyStyles(h.userStyles)}function ce(e,t,o,n){var r=ge(e,t),i=t.settings;if(i.horizontalPageBreakBehaviour==="afterAllRows")r.forEach(function(a,h){e.applyStyles(e.userStyles),h>0?M(e,t,o,n,a.columns,!0):ht(e,t,n,a.columns),ve(e,t,o,n,a.columns),q(e,t,n,a.columns)});else for(var l=-1,d=r[0],s=function(){var a=l;if(d){e.applyStyles(e.userStyles);var h=d.columns;l>=0?M(e,t,o,n,h,!0):ht(e,t,n,h),a=ft(e,t,l+1,n,h),q(e,t,n,h)}var c=a-l;r.slice(1).forEach(function(v){e.applyStyles(e.userStyles),M(e,t,o,n,v.columns,!0),ft(e,t,l+1,n,v.columns,c),q(e,t,n,v.columns)}),l=a};l<t.body.length-1;)s()}function ht(e,t,o,n){var r=t.settings;e.applyStyles(e.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(i){return T(e,t,i,o,n)})}function ve(e,t,o,n,r){e.applyStyles(e.userStyles),t.body.forEach(function(i,l){var d=l===t.body.length-1;V(e,t,i,d,o,n,r)})}function ft(e,t,o,n,r,i){e.applyStyles(e.userStyles),i=i??t.body.length;var l=Math.min(o+i,t.body.length),d=-1;return t.body.slice(o,l).forEach(function(s,a){var h=o+a===t.body.length-1,c=Wt(e,t,h,n);s.canEntireRowFit(c,r)&&(T(e,t,s,n,r),d=o+a)}),d}function q(e,t,o,n){var r=t.settings;e.applyStyles(e.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(i){return T(e,t,i,o,n)})}function pe(e,t,o){var n=o.getLineHeight(e.styles.fontSize),r=e.padding("vertical"),i=Math.floor((t-r)/n);return Math.max(0,i)}function ye(e,t,o,n){var r={};e.spansMultiplePages=!0,e.height=0;for(var i=0,l=0,d=o.columns;l<d.length;l++){var s=d[l],a=e.cells[s.index];if(a){Array.isArray(a.text)||(a.text=[a.text]);var h=new Ct(a.raw,a.styles,a.section);h=k(h,a),h.text=[];var c=pe(a,t,n);a.text.length>c&&(h.text=a.text.splice(c,a.text.length));var v=n.scaleFactor(),p=n.getLineHeightFactor();a.contentHeight=a.getContentHeight(v,p),a.contentHeight>=t&&(a.contentHeight=t,h.styles.minCellHeight-=t),a.contentHeight>e.height&&(e.height=a.contentHeight),h.contentHeight=h.getContentHeight(v,p),h.contentHeight>i&&(i=h.contentHeight),r[s.index]=h}}var y=new Pt(e.raw,-1,e.section,r,!0);y.height=i;for(var w=0,b=o.columns;w<b.length;w++){var s=b[w],h=y.cells[s.index];h&&(h.height=y.height);var a=e.cells[s.index];a&&(a.height=e.height)}return y}function me(e,t,o,n){var r=e.pageSize().height,i=n.settings.margin,l=i.top+i.bottom,d=r-l;t.section==="body"&&(d-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var s=t.getMinimumRowHeight(n.columns,e),a=s<o;if(s>d)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!a)return!1;var h=t.hasRowSpan(n.columns),c=t.getMaxCellHeight(n.columns)>d;return c?(h&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(h||n.settings.rowPageBreak==="avoid")}function V(e,t,o,n,r,i,l){var d=Wt(e,t,n,i);if(o.canEntireRowFit(d,l))T(e,t,o,i,l);else if(me(e,o,d,t)){var s=ye(o,d,t,e);T(e,t,o,i,l),M(e,t,r,i,l),V(e,t,s,n,r,i,l)}else M(e,t,r,i,l),V(e,t,o,n,r,i,l)}function T(e,t,o,n,r){n.x=t.settings.margin.left;for(var i=0,l=r;i<l.length;i++){var d=l[i],s=o.cells[d.index];if(!s){n.x+=d.width;continue}e.applyStyles(s.styles),s.x=n.x,s.y=n.y;var a=t.callCellHooks(e,t.hooks.willDrawCell,s,o,d,n);if(a===!1){n.x+=d.width;continue}we(e,s,n);var h=s.getTextPos();ct(s.text,h.x,h.y,{halign:s.styles.halign,valign:s.styles.valign,maxWidth:Math.ceil(s.width-s.padding("left")-s.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,s,o,d,n),n.x+=d.width}n.y+=o.height}function we(e,t,o){var n=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof n.lineWidth=="number"){var r=mt(n.lineWidth,n.fillColor);r&&e.rect(t.x,o.y,t.width,t.height,r)}else typeof n.lineWidth=="object"&&(n.fillColor&&e.rect(t.x,o.y,t.width,t.height,"F"),be(e,t,o,n.lineWidth))}function be(e,t,o,n){var r,i,l,d;n.top&&(r=o.x,i=o.y,l=o.x+t.width,d=o.y,n.right&&(l+=.5*n.right),n.left&&(r-=.5*n.left),s(n.top,r,i,l,d)),n.bottom&&(r=o.x,i=o.y+t.height,l=o.x+t.width,d=o.y+t.height,n.right&&(l+=.5*n.right),n.left&&(r-=.5*n.left),s(n.bottom,r,i,l,d)),n.left&&(r=o.x,i=o.y,l=o.x,d=o.y+t.height,n.top&&(i-=.5*n.top),n.bottom&&(d+=.5*n.bottom),s(n.left,r,i,l,d)),n.right&&(r=o.x+t.width,i=o.y,l=o.x+t.width,d=o.y+t.height,n.top&&(i-=.5*n.top),n.bottom&&(d+=.5*n.bottom),s(n.right,r,i,l,d));function s(a,h,c,v,p){e.getDocument().setLineWidth(a),e.getDocument().line(h,c,v,p,"S")}}function Wt(e,t,o,n){var r=t.settings.margin.bottom,i=t.settings.showFoot;return(i==="everyPage"||i==="lastPage"&&o)&&(r+=t.getFootHeight(t.columns)),e.pageSize().height-n.y-r}function M(e,t,o,n,r,i){r===void 0&&(r=[]),i===void 0&&(i=!1),e.applyStyles(e.userStyles),t.settings.showFoot==="everyPage"&&!i&&t.foot.forEach(function(d){return T(e,t,d,n,r)}),t.callEndPageHooks(e,n);var l=t.settings.margin;yt(e,t,o,n),Ht(e),t.pageNumber++,n.x=l.left,n.y=l.top,o.y=l.top,t.callWillDrawPageHooks(e,n),t.settings.showHead==="everyPage"&&(t.head.forEach(function(d){return T(e,t,d,n,r)}),e.applyStyles(e.userStyles))}function Ht(e){var t=e.pageNumber();e.setPage(t+1);var o=e.pageNumber();return o===t?(e.addPage(),!0):!1}function xe(e){e.API.autoTable=function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];var n=t[0],r=St(this,n),i=Ft(this,r);return Dt(this,i),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(t,o,n,r){ct(t,o,n,r,this)},e.API.autoTableSetDefaults=function(t){return A.setDefaults(t,this),this},e.autoTableSetDefaults=function(t,o){A.setDefaults(t,o)},e.API.autoTableHtmlToJson=function(t,o){var n;if(o===void 0&&(o=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var r=new A(this),i=xt(r,t,window,o,!1),l=i.head,d=i.body,s=((n=l[0])===null||n===void 0?void 0:n.map(function(a){return a.content}))||[];return{columns:s,rows:d,data:d}}}var G;function Se(e,t){var o=St(e,t),n=Ft(e,o);Dt(e,n)}try{if(typeof window<"u"&&window){var ut=window,gt=ut.jsPDF||((G=ut.jspdf)===null||G===void 0?void 0:G.jsPDF);gt&&xe(gt)}}catch(e){console.error("Could not apply autoTable plugin",e)}const Pe=e=>new Promise((t,o)=>{const n=new Image;n.src=e,n.onload=()=>t(n),n.onerror=o}),Ce=async(e,t,o)=>{if(!e.Nombre.trim()){alert("‚ùå Ingrese el nombre del cliente");return}try{const n=new Date().toISOString().split("T")[0],r=e.Nombre.trim().replace(/\s+/g,"_"),i=new Bt({orientation:"portrait",unit:"pt",format:"a4",precision:16});i.setFont("helvetica","normal");const l=i.internal.pageSize.getWidth(),d=i.internal.pageSize.getHeight(),a=await Pe("/logo_mh.png"),h=40,c=50,v=()=>{i.addImage(a,"PNG",20,10,h,h),i.setFontSize(14),i.setTextColor(21,28,166),i.text("Lista productos MH",l/2,22,{align:"center"}),i.setFontSize(12),i.setTextColor(0,0,0),i.text(`Cliente: ${e.Nombre}`,l/2,38,{align:"center"}),i.setFontSize(10),i.text(`Fecha: ${n}`,l/2,54,{align:"center"})};v();const p=["Producto","Marca","Presentaci√≥n","Precio","Promoci√≥n","Descuento %"],y=t.map(w=>[w.NombreProducto||"",w.Marca||"",w.Presentacion||"",w.PrecioFarmacia!=null?"$"+Number(w.PrecioFarmacia).toFixed(2):"N/D",w.Promocion||"",w.Descuento&&!isNaN(Number(w.Descuento))?w.Descuento+" %":""]);Se(i,{startY:c+10,margin:{top:c+15,left:10,right:10},head:[p],body:y,theme:"grid",tableWidth:"auto",styles:{cellPadding:3,overflow:"linebreak",fontSize:10,font:"helvetica",lineColor:180,lineWidth:.5,halign:"center",valign:"middle"},headStyles:{fillColor:[21,28,166],textColor:"#fff",fontSize:11,fontStyle:"bold"},columnStyles:{0:{halign:"left",cellWidth:"auto",minCellWidth:60},1:{cellWidth:"auto",minCellWidth:40},2:{cellWidth:"auto",minCellWidth:60},3:{cellWidth:50},4:{cellWidth:"auto",minCellWidth:50},5:{cellWidth:50}},didDrawPage:()=>{const w=i.internal.getNumberOfPages();i.setFontSize(10),i.text(`P√°gina ${w}`,l-40,d-20),v()}}),i.save(`Lista_MH_${r}_${n}.pdf`),o.success("PDF generado correctamente")}catch(n){console.error(n),o.error("Error al generar PDF")}},Fe={class:"container px-0"},De={key:0,class:"row mb-4"},We={class:"col-md-3"},He={class:"col-md-3"},ke={class:"col-md-3"},Te={class:"col-md-3"},_e={class:"col-md-3"},Re={key:1,class:"mt-4 d-flex justify-content-around flex-wrap gap-4"},Ae=["disabled"],ze=["disabled"],Ee={key:2,class:"mt-4"},Ne={key:0,class:"export-overlay"},je={key:1,class:"mt-4"},Be={class:"row justify-content-end"},Me={class:"col-md-4"},Le={class:"list-group"},Ie={class:"list-group-item d-flex justify-content-between"},$e={class:"list-group-item d-flex justify-content-between"},Ve={class:"list-group-item d-flex justify-content-between"},Oe={class:"list-group-item d-flex justify-content-between bg-light"},Ye={class:"fw-bold text-success"},Ue={key:2,class:"table-container",style:{"margin-bottom":"20px"}},Je={class:"table table-bordered table-sm table-striped text-center align-middle tableProductos mx-auto"},Ke={"data-label":"Nombre"},qe={"data-label":"Presentaci√≥n"},Ge={"data-label":"Principio Activo"},Qe={"data-label":"Precio Farmacia"},Xe={"data-label":"Promoci√≥n"},Ze={"data-label":"Descuento"},tn={"data-label":"Marca"},en={"data-label":"IVA"},nn={"data-label":"Cantidad"},on=["onUpdate:modelValue","onChange"],rn={"data-label":"Cantidad a recibir"},an={"data-label":"Precio total producto"},sn={"data-label":"Acciones"},ln=["onClick"],dn={key:3,class:"mobile-cards",style:{"margin-bottom":"20px"}},hn={class:"card-body"},fn={class:"d-flex justify-content-between align-items-start mb-2"},un={class:"product-info"},gn={class:"card-title mb-1"},cn={class:"text-muted small"},vn={class:"price-info"},pn={class:"fw-bold text-success fs-5"},yn={class:"text-muted small"},mn={class:"mb-1"},wn={class:"badge bg-info text-dark ms-1"},bn={key:0},xn={class:"badge bg-warning text-dark ms-1"},Sn={class:"quantity-controls p-2 rounded bg-light"},Pn={class:"d-flex align-items-center justify-content-between flex-wrap gap-2"},Cn={class:"d-flex align-items-center"},Fn=["onUpdate:modelValue","onChange"],Dn={class:"ms-2"},Wn={class:"badge bg-success"},Hn={class:"quantity-controls p-2 rounded bg-light mt-2"},kn={class:"ms-2"},Tn={class:"d-grid mt-3"},_n=["onClick"],Rn={key:3,class:"alert alert-info mt-4"},An={__name:"CarritoView",setup(e){const t=Rt(),o=()=>{Ce(s.value,r.value,t)},n=H(0),r=H([]),i=H(0),l=H(!1),d=H(!1),s=H({Nombre:"",Ciudad:"",Fecha:"",Vendedor:""}),a=H(0),h=H(0),c=H(0),v=()=>{a.value=0,h.value=0,c.value=0,r.value.forEach(x=>{const u=x.PrecioFarmacia*x.cantidad,g=Number(x.IVA);g>0?(a.value+=u,c.value+=u*(g/100)):h.value+=u}),i.value=a.value+h.value+c.value};At(()=>{const x=JSON.parse(localStorage.getItem("carrito"))||[];r.value=x,p(),v(),s.value.Fecha=new Date().toISOString().split("T")[0];const u=window.matchMedia("(max-width: 767px)"),g=m=>{l.value=m.matches!==void 0?m.matches:u.matches};g(u);try{u.addEventListener("change",g)}catch{u.addListener(g)}zt(()=>{try{u.removeEventListener("change",g)}catch{u.removeListener(g)}})});const p=()=>{i.value=r.value.reduce((x,u)=>{const g=u.IVA>0?u.IVA:0,m=u.PrecioFarmacia*u.cantidad*(1+g/100);return x+m},0)},y=(x,u,g)=>{r.value[x].cantidad<1&&(r.value[x].cantidad=1),localStorage.setItem("carrito",JSON.stringify(r.value)),p(),v(),n.value=B(u,g).total},w=x=>{try{U.confirm("Confirmar eliminaci√≥n","¬øDesea eliminar este producto del carrito?",function(){r.value.splice(x,1),localStorage.setItem("carrito",JSON.stringify(r.value)),p(),v(),t.success("Producto eliminado")},function(){})}catch{r.value.splice(x,1),localStorage.setItem("carrito",JSON.stringify(r.value)),p(),v()}},b=async()=>{const u=["Nombre","Ciudad","Fecha","Vendedor","Tipo"].filter(g=>!s.value[g]);if(u.length){U.alert(`‚ùå Faltan campos obligatorios: ${u.join(", ")}`);return}d.value=!0;try{const g=new Nt.Workbook,m=g.addWorksheet(s.value.Tipo);m.addRow([`Datos ${s.value.Tipo}`]),m.addRow(["Nombre",s.value.Nombre]),m.addRow(["Ciudad",s.value.Ciudad]),m.addRow(["Fecha",s.value.Fecha]),m.addRow(["Vendedor",s.value.Vendedor]),m.addRow(["Tipo",s.value.Tipo]),m.addRow([]);let W=[],Y=[];s.value.Tipo==="Pedido"&&(W=["Cantidad","Promoci√≥n","Nombre Producto","Lote","Fecha de Vencimiento"],Y=r.value.map(P=>{const{promo:_,total:z,detalle:et,cantidad:nt}=B(P.cantidad,P.Promocion);return[P.cantidad,_,P.NombreProducto,"",""]})),s.value.Tipo==="Proforma"&&(W=["Cantidad","Promoci√≥n","Nombre Producto","Marca","Precio Farmacia","Total"],Y=r.value.map(P=>{const _=P.PrecioFarmacia*P.cantidad;return[P.cantidad,B(P.cantidad,P.Promocion).promo,P.NombreProducto,P.Marca,P.PrecioFarmacia,_.toFixed(2)]}));const tt=m.addRow(W);if(tt.height=30,tt.eachCell(P=>{P.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFCCE5FF"}},P.font={bold:!0,size:12,color:{argb:"FF000000"}},P.alignment={horizontal:"center",vertical:"middle",wrapText:!0},P.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}}}),s.value.Tipo==="Pedido"&&(m.getColumn(1).width=15,m.getColumn(2).width=15,m.getColumn(3).width=35,m.getColumn(4).width=40,m.getColumn(5).width=40),s.value.Tipo==="Proforma"&&(m.getColumn(1).width=15,m.getColumn(2).width=15,m.getColumn(3).width=35,m.getColumn(4).width=35,m.getColumn(5).width=15,m.getColumn(6).width=20),Y.forEach(P=>{const _=m.addRow(P);_.height=55,_.eachCell(z=>{z.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},z.alignment={vertical:"middle",horizontal:"center",wrapText:!0}})}),s.value.Tipo==="Proforma"){m.addRow([]);const P=m.addRow(["","","","","Subtotal 15%:",`$ ${a.value.toFixed(2)}`]),_=m.addRow(["","","","","Subtotal 0%:",`$ ${h.value.toFixed(2)}`]),z=m.addRow(["","","","","IVA 15%:",`$ ${c.value.toFixed(2)}`]),et=m.addRow(["","","","","VALOR TOTAL:",`$ ${i.value.toFixed(2)}`]);[P,_,z,et].forEach(nt=>{nt.eachCell(L=>{L.value?.toString().trim()&&(L.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},L.alignment={vertical:"middle",horizontal:"center",wrapText:!0},L.font={bold:!0})})})}const kt=await g.xlsx.writeBuffer(),Tt=`${s.value.Tipo}_Cliente_${s.value.Nombre}_ciudad_${s.value.Ciudad}_Cliente_${s.value.Fecha}.xlsx`;jt.saveAs(new Blob([kt]),Tt),t.success("Excel generado correctamente")}catch(g){console.error("Error generando Excel:",g),t.error("Ocurri√≥ un error al generar el Excel")}finally{d.value=!1}},C=async()=>{try{U.confirm("Vaciar carrito","¬øEst√° seguro que desea vaciar todo el carrito? Esta acci√≥n no se puede deshacer.",function(){localStorage.removeItem("carrito"),r.value=[],p(),v(),t.success("Carrito vaciado")},function(){})}catch{localStorage.removeItem("carrito"),r.value=[]}};return(x,u)=>(D(),F("div",Fe,[u[28]||(u[28]=f("h2",{class:"text-center mb-4"},"üõí Carrito de Compras",-1)),r.value.length?(D(),F("div",De,[f("div",We,[u[5]||(u[5]=f("label",{class:"form-label"},"Nombre cliente",-1)),R(f("input",{"onUpdate:modelValue":u[0]||(u[0]=g=>s.value.Nombre=g),type:"text",class:"form-control"},null,512),[[N,s.value.Nombre]])]),f("div",He,[u[6]||(u[6]=f("label",{class:"form-label"},"Ciudad",-1)),R(f("input",{"onUpdate:modelValue":u[1]||(u[1]=g=>s.value.Ciudad=g),type:"text",class:"form-control"},null,512),[[N,s.value.Ciudad]])]),f("div",ke,[u[7]||(u[7]=f("label",{class:"form-label"},"Fecha",-1)),R(f("input",{"onUpdate:modelValue":u[2]||(u[2]=g=>s.value.Fecha=g),type:"date",readonly:"",disabled:"",class:"form-control"},null,512),[[N,s.value.Fecha]])]),f("div",Te,[u[9]||(u[9]=f("label",{class:"form-label"},"Vendedor",-1)),R(f("select",{"onUpdate:modelValue":u[3]||(u[3]=g=>s.value.Vendedor=g),class:"form-select"},[...u[8]||(u[8]=[f("option",{value:"",disabled:"",selected:""},"Seleccione",-1),f("option",{value:"Diana Benalc√°zar"},"Diana Benalc√°zar",-1)])],512),[[ot,s.value.Vendedor]])]),f("div",_e,[u[11]||(u[11]=f("label",{class:"form-label"},"Tipo de documento",-1)),R(f("select",{"onUpdate:modelValue":u[4]||(u[4]=g=>s.value.Tipo=g),class:"form-select"},[...u[10]||(u[10]=[f("option",{value:"",disabled:"",selected:""},"Seleccione",-1),f("option",{value:"Pedido"},"Pedido",-1),f("option",{value:"Proforma"},"Proforma",-1)])],512),[[ot,s.value.Tipo]])])])):E("",!0),u[29]||(u[29]=f("hr",{style:{border:"solid 1px silver"}},null,-1)),r.value.length?(D(),F("div",Re,[f("button",{onClick:C,class:"btn btn-warning"}," Vaciar carrito "),f("button",{class:"btn btn-primary",onClick:b,disabled:!r.value.length}," Exportar Excel ",8,Ae),f("button",{class:"btn btn-success",onClick:o,disabled:!r.value.length}," Exportar PDF ",8,ze)])):E("",!0),u[30]||(u[30]=f("hr",{style:{border:"solid 1px silver"}},null,-1)),r.value.length?(D(),F("div",Ee,[d.value?(D(),F("div",Ne,[...u[12]||(u[12]=[f("div",{class:"export-spinner","aria-hidden":"true"},null,-1),f("div",{class:"export-text"},"Generando archivo, por favor espere...",-1)])])):E("",!0),r.value.length?(D(),F("div",je,[f("div",Be,[f("div",Me,[f("ul",Le,[f("li",Ie,[u[13]||(u[13]=f("strong",null,"Subtotal 15%:",-1)),f("span",null,"$ "+S(a.value.toFixed(2)),1)]),f("li",$e,[u[14]||(u[14]=f("strong",null,"Subtotal 0%:",-1)),f("span",null,"$ "+S(h.value.toFixed(2)),1)]),f("li",Ve,[u[15]||(u[15]=f("strong",null,"IVA 15%:",-1)),f("span",null,"$ "+S(c.value.toFixed(2)),1)]),f("li",Oe,[u[16]||(u[16]=f("strong",null,"Total:",-1)),f("span",Ye,"$ "+S(i.value.toFixed(2)),1)])])])])])):E("",!0),u[27]||(u[27]=f("hr",{style:{border:"solid 1px silver"}},null,-1)),l.value?(D(),F("div",dn,[(D(!0),F(rt,null,it(r.value,(g,m)=>(D(),F("div",{key:g.id,class:"card mb-3 mobile-card"},[f("div",hn,[f("div",fn,[f("div",un,[f("h5",gn,S(g.NombreProducto),1),f("div",cn,[f("div",null,[u[18]||(u[18]=f("strong",null,"Marca:",-1)),j(" "+S(g.Marca),1)]),f("div",null,[u[19]||(u[19]=f("strong",null,"Presentaci√≥n:",-1)),j(" "+S(g.Presentacion),1)]),f("div",null,[u[20]||(u[20]=f("strong",null,"P. Activo:",-1)),j(" "+S(g.PrincipioActivo||"-"),1)])])]),f("div",vn,[f("div",pn," $ "+S(Number(g.PrecioFarmacia).toFixed(2)),1),f("div",yn," IVA: "+S(g.IVA>0?g.IVA+"%":"No aplica"),1)])]),f("div",{class:Et(["promo-info p-2 mb-2 rounded",g.Promocion?"bg-light":""])},[f("div",mn,[u[21]||(u[21]=f("strong",{class:"text-primary"},"Promoci√≥n:",-1)),f("span",wn,S(g.Promocion||"Sin promoci√≥n"),1)]),g.Descuento&&Number(g.Descuento)!==0?(D(),F("div",bn,[u[22]||(u[22]=f("strong",{class:"text-primary"},"Descuento:",-1)),f("span",xn,S(g.Descuento)+"%",1)])):E("",!0)],2),f("div",Sn,[f("div",Pn,[f("div",Cn,[u[23]||(u[23]=f("label",{class:"me-2 fw-bold mb-0"},"Cantidad:",-1)),R(f("input",{type:"number",min:"0","onUpdate:modelValue":W=>g.cantidad=W,onChange:W=>y(m,g.cantidad,g.Promocion),class:"form-control",style:{width:"80px"}},null,40,Fn),[[N,g.cantidad,void 0,{number:!0}]])]),f("div",Dn,[u[24]||(u[24]=f("strong",null,"A recibir: ",-1)),f("span",Wn,S(I(B)(g.cantidad,g.Promocion).total),1)])])]),f("div",Hn,[f("div",kn,[u[25]||(u[25]=f("strong",null,"Precio total: ",-1)),j(" $ "+S(I(at)(g.cantidad,g.PrecioFarmacia).toFixed(2)),1)])]),f("div",Tn,[f("button",{class:"btn btn-outline-danger",onClick:W=>w(m)},[...u[26]||(u[26]=[f("i",{class:"fas fa-trash-alt me-2"},null,-1),j("Eliminar producto ",-1)])],8,_n)])])]))),128))])):(D(),F("div",Ue,[f("table",Je,[u[17]||(u[17]=f("thead",null,[f("tr",null,[f("th",{class:"text-wrap fs-6 text"},"Nombre"),f("th",{class:"text-wrap fs-6 text"},"Presentaci√≥n"),f("th",{class:"text-wrap fs-6 text"},"Principio Activo"),f("th",{class:"text-wrap fs-6 text"},"P FARMACIA"),f("th",{class:"text-wrap fs-6 text"},"Promoci√≥n"),f("th",{class:"text-wrap fs-6 text"},"Descuento"),f("th",{class:"text-wrap fs-6 text"},"Marca"),f("th",{class:"text-wrap fs-6 text"},"IVA"),f("th",{class:"text-wrap fs-6 text"},"Cantidad"),f("th",{class:"text-wrap fs-6 text"},"A recibir"),f("th",{class:"text-wrap fs-6 text"},"Precio total producto"),f("th",{class:"text-wrap fs-6 text"},"Acciones")])],-1)),f("tbody",null,[(D(!0),F(rt,null,it(r.value,(g,m)=>(D(),F("tr",{key:g.id},[f("td",Ke,S(g.NombreProducto),1),f("td",qe,S(g.Presentacion),1),f("td",Ge,S(g.PrincipioActivo),1),f("td",Qe,"$ "+S(g.PrecioFarmacia),1),f("td",Xe,S(g.Promocion),1),f("td",Ze,S(g.Descuento!==void 0&&g.Descuento!==null&&Number(g.Descuento)!==0?g.Descuento:""),1),f("td",tn,S(g.Marca),1),f("td",en,S(g.IVA>0?g.IVA+"%":"No aplica"),1),f("td",nn,[R(f("input",{type:"number",min:"0","onUpdate:modelValue":W=>g.cantidad=W,onChange:W=>y(m,g.cantidad,g.Promocion),class:"form-control form-control-sm",style:{width:"80px"}},null,40,on),[[N,g.cantidad,void 0,{number:!0}]])]),f("td",rn,S(I(B)(g.cantidad,g.Promocion).total),1),f("td",an," $ "+S(I(at)(g.cantidad,g.PrecioFarmacia).toFixed(2)),1),f("td",sn,[f("button",{class:"btn btn-danger btn-sm",onClick:W=>w(m)}," Eliminar ",8,ln)])]))),128))])])]))])):(D(),F("div",Rn,"El carrito est√° vac√≠o."))]))}},Ln=_t(An,[["__scopeId","data-v-7ba2d2e8"]]);export{Ln as default};
