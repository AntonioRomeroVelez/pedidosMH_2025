import{_ as Rt,m as At,r as _,o as zt,y as Et,b as F,d as D,e as u,i as j,w as E,v as B,s as at,t as S,F as st,h as lt,z as K,k as M,x as Nt,p as q}from"./index-YrTeHBoU.js";import{E as jt}from"./exceljs.min-DPYv9eOq.js";import{F as Bt}from"./FileSaver.min-lDEsw7zW.js";import{c as L,a as dt}from"./utility-CvRbycmg.js";import{E as Mt}from"./jspdf.es.min-CaKRClIM.js";function yt(e,t,r,n,o){n=n||{};var i=1.15,l=o.internal.scaleFactor,s=o.internal.getFontSize()/l,d=o.getLineHeightFactor?o.getLineHeightFactor():i,a=s*d,f=/\r\n|\r|\n/g,v="",c=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(v=typeof e=="string"?e.split(f):e,c=v.length||1),r+=s*(2-i),n.valign==="middle"?r-=c/2*a:n.valign==="bottom"&&(r-=c*a),n.halign==="center"||n.halign==="right"){var p=s;if(n.halign==="center"&&(p*=.5),v&&c>=1){for(var m=0;m<v.length;m++)o.text(v[m],t-o.getStringUnitWidth(v[m])*p,r),r+=a;return o}t-=o.getStringUnitWidth(e)*p}return n.halign==="justify"?o.text(e,t,r,{maxWidth:n.maxWidth||100,align:"justify"}):o.text(e,t,r),o}var ft={},N=(function(){function e(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(t,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=t:ft=t},e.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},e.prototype.applyStyles=function(t,r){var n,o,i;r===void 0&&(r=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var l=this.jsPDFDocument.internal.getFont(),s=l.fontStyle,d=l.fontName;if(t.font&&(d=t.font),t.fontStyle){s=t.fontStyle;var a=this.getFontList()[d];a&&a.indexOf(s)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(a[0]),s=a[0])}if(this.jsPDFDocument.setFont(d,s),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!r){var f=e.unifyColor(t.fillColor);f&&(n=this.jsPDFDocument).setFillColor.apply(n,f),f=e.unifyColor(t.textColor),f&&(o=this.jsPDFDocument).setTextColor.apply(o,f),f=e.unifyColor(t.lineColor),f&&(i=this.jsPDFDocument).setDrawColor.apply(i,f),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(t,r,n){return this.jsPDFDocument.splitTextToSize(t,r,n)},e.prototype.rect=function(t,r,n,o,i){return this.jsPDFDocument.rect(t,r,n,o,i)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return ft||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e})(),rt=function(e,t){return rt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(r[o]=n[o])},rt(e,t)};function mt(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");rt(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var wt=(function(e){mt(t,e);function t(r){var n=e.call(this)||this;return n._element=r,n}return t})(Array);function Lt(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function It(e){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[e]}function G(e,t,r){r.applyStyles(t,!0);var n=Array.isArray(e)?e:[e],o=n.map(function(i){return r.getTextWidth(i)}).reduce(function(i,l){return Math.max(i,l)},0);return o}function bt(e,t,r,n){var o=t.settings.tableLineWidth,i=t.settings.tableLineColor;e.applyStyles({lineWidth:o,lineColor:i});var l=xt(o,!1);l&&e.rect(r.x,r.y,t.getWidth(e.pageSize().width),n.y-r.y,l)}function xt(e,t){var r=e>0,n=t||t===0;return r&&n?"DF":r?"S":n?"F":null}function X(e,t){var r,n,o,i;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=t}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(r=e.left)!==null&&r!==void 0?r:t,top:(n=e.top)!==null&&n!==void 0?n:t,right:(o=e.right)!==null&&o!==void 0?o:t,bottom:(i=e.bottom)!==null&&i!==void 0?i:t}):(typeof e!="number"&&(e=t),{top:e,right:e,bottom:e,left:e})}function St(e,t){var r=X(t.settings.margin,0);return e.pageSize().width-(r.left+r.right)}function $t(e,t,r,n,o){var i={},l=1.3333333333333333,s=Z(t,function(w){return o.getComputedStyle(w).backgroundColor});s!=null&&(i.fillColor=s);var d=Z(t,function(w){return o.getComputedStyle(w).color});d!=null&&(i.textColor=d);var a=Ot(n,r);a&&(i.cellPadding=a);var f="borderTopColor",v=l*r,c=n.borderTopWidth;if(n.borderBottomWidth===c&&n.borderRightWidth===c&&n.borderLeftWidth===c){var p=(parseFloat(c)||0)/v;p&&(i.lineWidth=p)}else i.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/v,right:(parseFloat(n.borderRightWidth)||0)/v,bottom:(parseFloat(n.borderBottomWidth)||0)/v,left:(parseFloat(n.borderLeftWidth)||0)/v},i.lineWidth.top||(i.lineWidth.right?f="borderRightColor":i.lineWidth.bottom?f="borderBottomColor":i.lineWidth.left&&(f="borderLeftColor"));var m=Z(t,function(w){return o.getComputedStyle(w)[f]});m!=null&&(i.lineColor=m);var C=["left","right","center","justify"];C.indexOf(n.textAlign)!==-1&&(i.halign=n.textAlign),C=["middle","bottom","top"],C.indexOf(n.verticalAlign)!==-1&&(i.valign=n.verticalAlign);var b=parseInt(n.fontSize||"");isNaN(b)||(i.fontSize=b/l);var P=Vt(n);P&&(i.fontStyle=P);var k=(n.fontFamily||"").toLowerCase();return e.indexOf(k)!==-1&&(i.font=k),i}function Vt(e){var t="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(t="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(t+="italic"),t}function Z(e,t){var r=Pt(e,t);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var o=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],i=parseInt(n[4]);return i===0||isNaN(o[0])||isNaN(o[1])||isNaN(o[2])?null:o}function Pt(e,t){var r=t(e);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?e.parentElement==null?null:Pt(e.parentElement,t):r}function Ot(e,t){var r=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],n=96/(72/t),o=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,i=r.map(function(s){return parseInt(s||"0")/n}),l=X(i,0);return o>l.top&&(l.top=o),o>l.bottom&&(l.bottom=o),l}function Ct(e,t,r,n,o){var i,l;n===void 0&&(n=!1),o===void 0&&(o=!1);var s;typeof t=="string"?s=r.document.querySelector(t):s=t;var d=Object.keys(e.getFontList()),a=e.scaleFactor(),f=[],v=[],c=[];if(!s)return console.error("Html table could not be found with input: ",t),{head:f,body:v,foot:c};for(var p=0;p<s.rows.length;p++){var m=s.rows[p],C=(l=(i=m?.parentElement)===null||i===void 0?void 0:i.tagName)===null||l===void 0?void 0:l.toLowerCase(),b=Yt(d,a,r,m,n,o);b&&(C==="thead"?f.push(b):C==="tfoot"?c.push(b):v.push(b))}return{head:f,body:v,foot:c}}function Yt(e,t,r,n,o,i){for(var l=new wt(n),s=0;s<n.cells.length;s++){var d=n.cells[s],a=r.getComputedStyle(d);if(o||a.display!=="none"){var f=void 0;i&&(f=$t(e,d,t,a,r)),l.push({rowSpan:d.rowSpan,colSpan:d.colSpan,styles:f,_element:d,content:Ut(d)})}}var v=r.getComputedStyle(n);if(l.length>0&&(o||v.display!=="none"))return l}function Ut(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),t.innerText||t.textContent||""}function Jt(e,t,r){for(var n=0,o=[e,t,r];n<o.length;n++){var i=o[n];i&&typeof i!="object"&&console.error("The options parameter should be of type object, is: "+typeof i),i.startY&&typeof i.startY!="number"&&(console.error("Invalid value for startY option",i.startY),delete i.startY)}}function R(e,t,r,n,o){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var i=Object(e),l=1;l<arguments.length;l++){var s=arguments[l];if(s!=null)for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&(i[d]=s[d])}return i}function Ft(e,t){var r=new N(e),n=r.getDocumentOptions(),o=r.getGlobalOptions();Jt(o,n,t);var i=R({},o,n,t),l;typeof window<"u"&&(l=window);var s=Kt(o,n,t),d=qt(o,n,t),a=Gt(r,i),f=Xt(r,i,l);return{id:t.tableId,content:f,hooks:d,styles:s,settings:a}}function Kt(e,t,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},o=function(d){if(d==="columnStyles"){var a=e[d],f=t[d],v=r[d];n.columnStyles=R({},a,f,v)}else{var c=[e,t,r],p=c.map(function(m){return m[d]||{}});n[d]=R({},p[0],p[1],p[2])}},i=0,l=Object.keys(n);i<l.length;i++){var s=l[i];o(s)}return n}function qt(e,t,r){for(var n=[e,t,r],o={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},i=0,l=n;i<l.length;i++){var s=l[i];s.didParseCell&&o.didParseCell.push(s.didParseCell),s.willDrawCell&&o.willDrawCell.push(s.willDrawCell),s.didDrawCell&&o.didDrawCell.push(s.didDrawCell),s.willDrawPage&&o.willDrawPage.push(s.willDrawPage),s.didDrawPage&&o.didDrawPage.push(s.didDrawPage)}return o}function Gt(e,t){var r,n,o,i,l,s,d,a,f,v,c,p,m=X(t.margin,40/e.scaleFactor()),C=(r=Qt(e,t.startY))!==null&&r!==void 0?r:m.top,b;t.showFoot===!0?b="everyPage":t.showFoot===!1?b="never":b=(n=t.showFoot)!==null&&n!==void 0?n:"everyPage";var P;t.showHead===!0?P="everyPage":t.showHead===!1?P="never":P=(o=t.showHead)!==null&&o!==void 0?o:"everyPage";var k=(i=t.useCss)!==null&&i!==void 0?i:!1,w=t.theme||(k?"plain":"striped"),h=!!t.horizontalPageBreak,g=(l=t.horizontalPageBreakRepeat)!==null&&l!==void 0?l:null;return{includeHiddenHtml:(s=t.includeHiddenHtml)!==null&&s!==void 0?s:!1,useCss:k,theme:w,startY:C,margin:m,pageBreak:(d=t.pageBreak)!==null&&d!==void 0?d:"auto",rowPageBreak:(a=t.rowPageBreak)!==null&&a!==void 0?a:"auto",tableWidth:(f=t.tableWidth)!==null&&f!==void 0?f:"auto",showHead:P,showFoot:b,tableLineWidth:(v=t.tableLineWidth)!==null&&v!==void 0?v:0,tableLineColor:(c=t.tableLineColor)!==null&&c!==void 0?c:200,horizontalPageBreak:h,horizontalPageBreakRepeat:g,horizontalPageBreakBehaviour:(p=t.horizontalPageBreakBehaviour)!==null&&p!==void 0?p:"afterAllRows"}}function Qt(e,t){var r=e.getLastAutoTable(),n=e.scaleFactor(),o=e.pageNumber(),i=!1;if(r&&r.startPageNumber){var l=r.startPageNumber+r.pageNumber-1;i=l===o}return typeof t=="number"?t:(t==null||t===!1)&&i&&r?.finalY!=null?r.finalY+20/n:null}function Xt(e,t,r){var n=t.head||[],o=t.body||[],i=t.foot||[];if(t.html){var l=t.includeHiddenHtml;if(r){var s=Ct(e,t.html,r,l,t.useCss)||{};n=s.head||n,o=s.body||n,i=s.foot||n}else console.error("Cannot parse html in non browser environment")}var d=t.columns||Zt(n,o,i);return{columns:d,head:n,body:o,foot:i}}function Zt(e,t,r){var n=e[0]||t[0]||r[0]||[],o=[];return Object.keys(n).filter(function(i){return i!=="_element"}).forEach(function(i){var l=1,s;Array.isArray(n)?s=n[parseInt(i)]:s=n[i],typeof s=="object"&&!Array.isArray(s)&&(l=s?.colSpan||1);for(var d=0;d<l;d++){var a=void 0;Array.isArray(n)?a=o.length:a=i+(d>0?"_".concat(d):"");var f={dataKey:a};o.push(f)}}),o}var ot=(function(){function e(t,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=t.getDocument()}return e})(),te=(function(e){mt(t,e);function t(r,n,o,i,l,s){var d=e.call(this,r,n,s)||this;return d.cell=o,d.row=i,d.column=l,d.section=i.section,d}return t})(ot),ee=(function(){function e(t,r){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return e.prototype.getHeadHeight=function(t){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.getFootHeight=function(t){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(t,r,n,o,i,l){for(var s=0,d=r;s<d.length;s++){var a=d[s],f=new te(t,this,n,o,i,l),v=a(f)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],v)return!1}return!0},e.prototype.callEndPageHooks=function(t,r){t.applyStyles(t.userStyles);for(var n=0,o=this.hooks.didDrawPage;n<o.length;n++){var i=o[n];i(new ot(t,this,r))}},e.prototype.callWillDrawPageHooks=function(t,r){for(var n=0,o=this.hooks.willDrawPage;n<o.length;n++){var i=o[n];i(new ot(t,this,r))}},e.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(o,i){return o+i.wrappedWidth},0);return r}else{var n=this.settings.margin;return t-n.left-n.right}},e})(),Dt=(function(){function e(t,r,n,o,i){i===void 0&&(i=!1),this.height=0,this.raw=t,t instanceof wt&&(this.raw=t._element,this.element=t._element),this.index=r,this.section=n,this.cells=o,this.spansMultiplePages=i}return e.prototype.getMaxCellHeight=function(t){var r=this;return t.reduce(function(n,o){var i;return Math.max(n,((i=r.cells[o.index])===null||i===void 0?void 0:i.height)||0)},0)},e.prototype.hasRowSpan=function(t){var r=this;return t.filter(function(n){var o=r.cells[n.index];return o?o.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(t,r){return this.getMaxCellHeight(r)<=t},e.prototype.getMinimumRowHeight=function(t,r){var n=this;return t.reduce(function(o,i){var l=n.cells[i.index];if(!l)return 0;var s=r.getLineHeight(l.styles.fontSize),d=l.padding("vertical"),a=d+s;return a>o?a:o},0)},e})(),Ht=(function(){function e(t,r,n){var o;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=t;var i=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,i=(o=t.content)!==null&&o!==void 0?o:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var l=i!=null?""+i:"",s=/\r\n|\r|\n/g;this.text=l.split(s)}return e.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");t=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var o=this.width-this.padding("horizontal");n=this.x+o/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:t}},e.prototype.getContentHeight=function(t,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,o=this.styles.fontSize/t*r,i=n*o+this.padding("vertical");return Math.max(i,this.styles.minCellHeight)},e.prototype.padding=function(t){var r=X(this.styles.cellPadding,0);return t==="vertical"?r.top+r.bottom:t==="horizontal"?r.left+r.right:r[t]},e})(),ne=(function(){function e(t,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=r,this.index=n}return e.prototype.getMaxCustomCellWidth=function(t){for(var r=0,n=0,o=t.allRows();n<o.length;n++){var i=o[n],l=i.cells[this.index];l&&typeof l.styles.cellWidth=="number"&&(r=Math.max(r,l.styles.cellWidth))}return r},e})();function re(e,t){oe(e,t);var r=[],n=0;t.columns.forEach(function(i){var l=i.getMaxCustomCellWidth(t);l?i.width=l:(i.width=i.wrappedWidth,r.push(i)),n+=i.width});var o=t.getWidth(e.pageSize().width)-n;o&&(o=it(r,o,function(i){return Math.max(i.minReadableWidth,i.minWidth)})),o&&(o=it(r,o,function(i){return i.minWidth})),o=Math.abs(o),!t.settings.horizontalPageBreak&&o>.1/e.scaleFactor()&&(o=o<1?o:Math.round(o),console.warn("Of the table content, ".concat(o," units width could not fit page"))),ae(t),se(t,e),ie(t)}function oe(e,t){var r=e.scaleFactor(),n=t.settings.horizontalPageBreak,o=St(e,t);t.allRows().forEach(function(i){for(var l=0,s=t.columns;l<s.length;l++){var d=s[l],a=i.cells[d.index];if(a){var f=t.hooks.didParseCell;t.callCellHooks(e,f,a,i,d,null);var v=a.padding("horizontal");a.contentWidth=G(a.text,a.styles,e)+v;var c=G(a.text.join(" ").split(/[^\S\u00A0]+/),a.styles,e);if(a.minReadableWidth=c+a.padding("horizontal"),typeof a.styles.cellWidth=="number")a.minWidth=a.styles.cellWidth,a.wrappedWidth=a.styles.cellWidth;else if(a.styles.cellWidth==="wrap"||n===!0)a.contentWidth>o?(a.minWidth=o,a.wrappedWidth=o):(a.minWidth=a.contentWidth,a.wrappedWidth=a.contentWidth);else{var p=10/r;a.minWidth=a.styles.minCellWidth||p,a.wrappedWidth=a.contentWidth,a.minWidth>a.wrappedWidth&&(a.wrappedWidth=a.minWidth)}}}}),t.allRows().forEach(function(i){for(var l=0,s=t.columns;l<s.length;l++){var d=s[l],a=i.cells[d.index];if(a&&a.colSpan===1)d.wrappedWidth=Math.max(d.wrappedWidth,a.wrappedWidth),d.minWidth=Math.max(d.minWidth,a.minWidth),d.minReadableWidth=Math.max(d.minReadableWidth,a.minReadableWidth);else{var f=t.styles.columnStyles[d.dataKey]||t.styles.columnStyles[d.index]||{},v=f.cellWidth||f.minCellWidth;v&&typeof v=="number"&&(d.minWidth=v,d.wrappedWidth=v)}a&&(a.colSpan>1&&!d.minWidth&&(d.minWidth=a.minWidth),a.colSpan>1&&!d.wrappedWidth&&(d.wrappedWidth=a.minWidth))}})}function it(e,t,r){for(var n=t,o=e.reduce(function(p,m){return p+m.wrappedWidth},0),i=0;i<e.length;i++){var l=e[i],s=l.wrappedWidth/o,d=n*s,a=l.width+d,f=r(l),v=a<f?f:a;t-=v-l.width,l.width=v}if(t=Math.round(t*1e10)/1e10,t){var c=e.filter(function(p){return t<0?p.width>r(p):!0});c.length&&(t=it(c,t,r))}return t}function ie(e){for(var t={},r=1,n=e.allRows(),o=0;o<n.length;o++)for(var i=n[o],l=0,s=e.columns;l<s.length;l++){var d=s[l],a=t[d.index];if(r>1)r--,delete i.cells[d.index];else if(a)a.cell.height+=i.height,r=a.cell.colSpan,delete i.cells[d.index],a.left--,a.left<=1&&delete t[d.index];else{var f=i.cells[d.index];if(!f)continue;if(f.height=i.height,f.rowSpan>1){var v=n.length-o,c=f.rowSpan>v?v:f.rowSpan;t[d.index]={cell:f,left:c,row:i}}}}}function ae(e){for(var t=e.allRows(),r=0;r<t.length;r++)for(var n=t[r],o=null,i=0,l=0,s=0;s<e.columns.length;s++){var d=e.columns[s];if(l-=1,l>1&&e.columns[s+1])i+=d.width,delete n.cells[d.index];else if(o){var a=o;delete n.cells[d.index],o=null,a.width=d.width+i}else{var a=n.cells[d.index];if(!a)continue;if(l=a.colSpan,i=0,a.colSpan>1){o=a,i+=d.width;continue}a.width=d.width+i}}}function se(e,t){for(var r={count:0,height:0},n=0,o=e.allRows();n<o.length;n++){for(var i=o[n],l=0,s=e.columns;l<s.length;l++){var d=s[l],a=i.cells[d.index];if(a){t.applyStyles(a.styles,!0);var f=a.width-a.padding("horizontal");if(a.styles.overflow==="linebreak")a.text=t.splitTextToSize(a.text,f+1/t.scaleFactor(),{fontSize:a.styles.fontSize});else if(a.styles.overflow==="ellipsize")a.text=ut(a.text,f,a.styles,t,"...");else if(a.styles.overflow==="hidden")a.text=ut(a.text,f,a.styles,t,"");else if(typeof a.styles.overflow=="function"){var v=a.styles.overflow(a.text,f);typeof v=="string"?a.text=[v]:a.text=v}a.contentHeight=a.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var c=a.contentHeight/a.rowSpan;a.rowSpan>1&&r.count*r.height<c*a.rowSpan?r={height:c,count:a.rowSpan}:r&&r.count>0&&r.height>c&&(c=r.height),c>i.height&&(i.height=c)}}r.count--}}function ut(e,t,r,n,o){return e.map(function(i){return le(i,t,r,n,o)})}function le(e,t,r,n,o){var i=1e4*n.scaleFactor();if(t=Math.ceil(t*i)/i,t>=G(e,r,n))return e;for(;t<G(e+o,r,n)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+o}function Wt(e,t){var r=new N(e),n=de(t,r.scaleFactor()),o=new ee(t,n);return re(r,o),r.applyStyles(r.userStyles),o}function de(e,t){var r=e.content,n=ue(r.columns);if(r.head.length===0){var o=ht(n,"head");o&&r.head.push(o)}if(r.foot.length===0){var o=ht(n,"foot");o&&r.foot.push(o)}var i=e.settings.theme,l=e.styles;return{columns:n,head:tt("head",r.head,n,l,i,t),body:tt("body",r.body,n,l,i,t),foot:tt("foot",r.foot,n,l,i,t)}}function tt(e,t,r,n,o,i){var l={},s=t.map(function(d,a){for(var f=0,v={},c=0,p=0,m=0,C=r;m<C.length;m++){var b=C[m];if(l[b.index]==null||l[b.index].left===0)if(p===0){var P=void 0;Array.isArray(d)?P=d[b.index-c-f]:P=d[b.dataKey];var k={};typeof P=="object"&&!Array.isArray(P)&&(k=P?.styles||{});var w=he(e,b,a,o,n,i,k),h=new Ht(P,w,e);v[b.dataKey]=h,v[b.index]=h,p=h.colSpan-1,l[b.index]={left:h.rowSpan-1,times:p}}else p--,c++;else l[b.index].left--,p=l[b.index].times,f++}return new Dt(d,a,e,v)});return s}function ht(e,t){var r={};return e.forEach(function(n){if(n.raw!=null){var o=fe(t,n.raw);o!=null&&(r[n.dataKey]=o)}}),Object.keys(r).length>0?r:null}function fe(e,t){if(e==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(e==="foot"&&typeof t=="object")return t.footer;return null}function ue(e){return e.map(function(t,r){var n,o;return typeof t=="object"?o=(n=t.dataKey)!==null&&n!==void 0?n:r:o=r,new ne(o,t,r)})}function he(e,t,r,n,o,i,l){var s=It(n),d;e==="head"?d=o.headStyles:e==="body"?d=o.bodyStyles:e==="foot"&&(d=o.footStyles);var a=R({},s.table,s[e],o.styles,d),f=o.columnStyles[t.dataKey]||o.columnStyles[t.index]||{},v=e==="body"?f:{},c=e==="body"&&r%2===0?R({},s.alternateRow,o.alternateRowStyles):{},p=Lt(i),m=R({},p,a,c,v);return R(m,l)}function ge(e,t,r){var n;r===void 0&&(r={});var o=St(e,t),i=new Map,l=[],s=[],d=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?d=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(d=[t.settings.horizontalPageBreakRepeat]),d.forEach(function(c){var p=t.columns.find(function(m){return m.dataKey===c||m.index===c});p&&!i.has(p.index)&&(i.set(p.index,!0),l.push(p.index),s.push(t.columns[p.index]),o-=p.wrappedWidth)});for(var a=!0,f=(n=r?.start)!==null&&n!==void 0?n:0;f<t.columns.length;){if(i.has(f)){f++;continue}var v=t.columns[f].wrappedWidth;if(a||o>=v)a=!1,l.push(f),s.push(t.columns[f]),o-=v;else break;f++}return{colIndexes:l,columns:s,lastIndex:f-1}}function ve(e,t){for(var r=[],n=0;n<t.columns.length;n++){var o=ge(e,t,{start:n});o.columns.length&&(r.push(o),n=o.lastIndex)}return r}function kt(e,t){var r=t.settings,n=r.startY,o=r.margin,i={x:o.left,y:n},l=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),s=n+o.bottom+l;if(r.pageBreak==="avoid"){var d=t.body,a=d.reduce(function(c,p){return c+p.height},0);s+=a}var f=new N(e);(r.pageBreak==="always"||r.startY!=null&&s>f.pageSize().height)&&(_t(f),i.y=o.top),t.callWillDrawPageHooks(f,i);var v=R({},i);t.startPageNumber=f.pageNumber(),r.horizontalPageBreak?ce(f,t,v,i):(f.applyStyles(f.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(c){return A(f,t,c,i,t.columns)}),f.applyStyles(f.userStyles),t.body.forEach(function(c,p){var m=p===t.body.length-1;Q(f,t,c,m,v,i,t.columns)}),f.applyStyles(f.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(c){return A(f,t,c,i,t.columns)})),bt(f,t,v,i),t.callEndPageHooks(f,i),t.finalY=i.y,e.lastAutoTable=t,f.applyStyles(f.userStyles)}function ce(e,t,r,n){var o=ve(e,t),i=t.settings;if(i.horizontalPageBreakBehaviour==="afterAllRows")o.forEach(function(a,f){e.applyStyles(e.userStyles),f>0?I(e,t,r,n,a.columns,!0):gt(e,t,n,a.columns),pe(e,t,r,n,a.columns),et(e,t,n,a.columns)});else for(var l=-1,s=o[0],d=function(){var a=l;if(s){e.applyStyles(e.userStyles);var f=s.columns;l>=0?I(e,t,r,n,f,!0):gt(e,t,n,f),a=vt(e,t,l+1,n,f),et(e,t,n,f)}var v=a-l;o.slice(1).forEach(function(c){e.applyStyles(e.userStyles),I(e,t,r,n,c.columns,!0),vt(e,t,l+1,n,c.columns,v),et(e,t,n,c.columns)}),l=a};l<t.body.length-1;)d()}function gt(e,t,r,n){var o=t.settings;e.applyStyles(e.userStyles),(o.showHead==="firstPage"||o.showHead==="everyPage")&&t.head.forEach(function(i){return A(e,t,i,r,n)})}function pe(e,t,r,n,o){e.applyStyles(e.userStyles),t.body.forEach(function(i,l){var s=l===t.body.length-1;Q(e,t,i,s,r,n,o)})}function vt(e,t,r,n,o,i){e.applyStyles(e.userStyles),i=i??t.body.length;var l=Math.min(r+i,t.body.length),s=-1;return t.body.slice(r,l).forEach(function(d,a){var f=r+a===t.body.length-1,v=Tt(e,t,f,n);d.canEntireRowFit(v,o)&&(A(e,t,d,n,o),s=r+a)}),s}function et(e,t,r,n){var o=t.settings;e.applyStyles(e.userStyles),(o.showFoot==="lastPage"||o.showFoot==="everyPage")&&t.foot.forEach(function(i){return A(e,t,i,r,n)})}function ye(e,t,r){var n=r.getLineHeight(e.styles.fontSize),o=e.padding("vertical"),i=Math.floor((t-o)/n);return Math.max(0,i)}function me(e,t,r,n){var o={};e.spansMultiplePages=!0,e.height=0;for(var i=0,l=0,s=r.columns;l<s.length;l++){var d=s[l],a=e.cells[d.index];if(a){Array.isArray(a.text)||(a.text=[a.text]);var f=new Ht(a.raw,a.styles,a.section);f=R(f,a),f.text=[];var v=ye(a,t,n);a.text.length>v&&(f.text=a.text.splice(v,a.text.length));var c=n.scaleFactor(),p=n.getLineHeightFactor();a.contentHeight=a.getContentHeight(c,p),a.contentHeight>=t&&(a.contentHeight=t,f.styles.minCellHeight-=t),a.contentHeight>e.height&&(e.height=a.contentHeight),f.contentHeight=f.getContentHeight(c,p),f.contentHeight>i&&(i=f.contentHeight),o[d.index]=f}}var m=new Dt(e.raw,-1,e.section,o,!0);m.height=i;for(var C=0,b=r.columns;C<b.length;C++){var d=b[C],f=m.cells[d.index];f&&(f.height=m.height);var a=e.cells[d.index];a&&(a.height=e.height)}return m}function we(e,t,r,n){var o=e.pageSize().height,i=n.settings.margin,l=i.top+i.bottom,s=o-l;t.section==="body"&&(s-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var d=t.getMinimumRowHeight(n.columns,e),a=d<r;if(d>s)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!a)return!1;var f=t.hasRowSpan(n.columns),v=t.getMaxCellHeight(n.columns)>s;return v?(f&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(f||n.settings.rowPageBreak==="avoid")}function Q(e,t,r,n,o,i,l){var s=Tt(e,t,n,i);if(r.canEntireRowFit(s,l))A(e,t,r,i,l);else if(we(e,r,s,t)){var d=me(r,s,t,e);A(e,t,r,i,l),I(e,t,o,i,l),Q(e,t,d,n,o,i,l)}else I(e,t,o,i,l),Q(e,t,r,n,o,i,l)}function A(e,t,r,n,o){n.x=t.settings.margin.left;for(var i=0,l=o;i<l.length;i++){var s=l[i],d=r.cells[s.index];if(!d){n.x+=s.width;continue}e.applyStyles(d.styles),d.x=n.x,d.y=n.y;var a=t.callCellHooks(e,t.hooks.willDrawCell,d,r,s,n);if(a===!1){n.x+=s.width;continue}be(e,d,n);var f=d.getTextPos();yt(d.text,f.x,f.y,{halign:d.styles.halign,valign:d.styles.valign,maxWidth:Math.ceil(d.width-d.padding("left")-d.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,d,r,s,n),n.x+=s.width}n.y+=r.height}function be(e,t,r){var n=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof n.lineWidth=="number"){var o=xt(n.lineWidth,n.fillColor);o&&e.rect(t.x,r.y,t.width,t.height,o)}else typeof n.lineWidth=="object"&&(n.fillColor&&e.rect(t.x,r.y,t.width,t.height,"F"),xe(e,t,r,n.lineWidth))}function xe(e,t,r,n){var o,i,l,s;n.top&&(o=r.x,i=r.y,l=r.x+t.width,s=r.y,n.right&&(l+=.5*n.right),n.left&&(o-=.5*n.left),d(n.top,o,i,l,s)),n.bottom&&(o=r.x,i=r.y+t.height,l=r.x+t.width,s=r.y+t.height,n.right&&(l+=.5*n.right),n.left&&(o-=.5*n.left),d(n.bottom,o,i,l,s)),n.left&&(o=r.x,i=r.y,l=r.x,s=r.y+t.height,n.top&&(i-=.5*n.top),n.bottom&&(s+=.5*n.bottom),d(n.left,o,i,l,s)),n.right&&(o=r.x+t.width,i=r.y,l=r.x+t.width,s=r.y+t.height,n.top&&(i-=.5*n.top),n.bottom&&(s+=.5*n.bottom),d(n.right,o,i,l,s));function d(a,f,v,c,p){e.getDocument().setLineWidth(a),e.getDocument().line(f,v,c,p,"S")}}function Tt(e,t,r,n){var o=t.settings.margin.bottom,i=t.settings.showFoot;return(i==="everyPage"||i==="lastPage"&&r)&&(o+=t.getFootHeight(t.columns)),e.pageSize().height-n.y-o}function I(e,t,r,n,o,i){o===void 0&&(o=[]),i===void 0&&(i=!1),e.applyStyles(e.userStyles),t.settings.showFoot==="everyPage"&&!i&&t.foot.forEach(function(s){return A(e,t,s,n,o)}),t.callEndPageHooks(e,n);var l=t.settings.margin;bt(e,t,r,n),_t(e),t.pageNumber++,n.x=l.left,n.y=l.top,r.y=l.top,t.callWillDrawPageHooks(e,n),t.settings.showHead==="everyPage"&&(t.head.forEach(function(s){return A(e,t,s,n,o)}),e.applyStyles(e.userStyles))}function _t(e){var t=e.pageNumber();e.setPage(t+1);var r=e.pageNumber();return r===t?(e.addPage(),!0):!1}function Se(e){e.API.autoTable=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0],o=Ft(this,n),i=Wt(this,o);return kt(this,i),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(t,r,n,o){yt(t,r,n,o,this)},e.API.autoTableSetDefaults=function(t){return N.setDefaults(t,this),this},e.autoTableSetDefaults=function(t,r){N.setDefaults(t,r)},e.API.autoTableHtmlToJson=function(t,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var o=new N(this),i=Ct(o,t,window,r,!1),l=i.head,s=i.body,d=((n=l[0])===null||n===void 0?void 0:n.map(function(a){return a.content}))||[];return{columns:d,rows:s,data:s}}}var nt;function Pe(e,t){var r=Ft(e,t),n=Wt(e,r);kt(e,n)}try{if(typeof window<"u"&&window){var ct=window,pt=ct.jsPDF||((nt=ct.jspdf)===null||nt===void 0?void 0:nt.jsPDF);pt&&Se(pt)}}catch(e){console.error("Could not apply autoTable plugin",e)}const Ce={class:"container px-0"},Fe={key:0,class:"row mb-4"},De={class:"col-md-3"},He={class:"col-md-3"},We={class:"col-md-3"},ke={class:"col-md-3"},Te={class:"col-md-3"},_e={key:1,class:"mt-4 d-flex justify-content-around flex-wrap gap-4"},Re=["disabled"],Ae=["disabled"],ze={key:2,class:"mt-4"},Ee={key:0,class:"export-overlay"},Ne={key:1,class:"mt-4"},je={class:"row justify-content-end"},Be={class:"col-md-4"},Me={class:"list-group"},Le={class:"list-group-item d-flex justify-content-between"},Ie={class:"list-group-item d-flex justify-content-between"},$e={class:"list-group-item d-flex justify-content-between"},Ve={class:"list-group-item d-flex justify-content-between bg-light"},Oe={class:"fw-bold text-success"},Ye={key:2,class:"table-container",style:{"margin-bottom":"20px"}},Ue={class:"table table-bordered table-sm table-striped text-center align-middle tableProductos mx-auto"},Je={"data-label":"Nombre"},Ke={"data-label":"Presentaci√≥n"},qe={"data-label":"Principio Activo"},Ge={"data-label":"Precio Farmacia"},Qe={"data-label":"Promoci√≥n"},Xe={"data-label":"Descuento"},Ze={"data-label":"Marca"},tn={"data-label":"IVA"},en={"data-label":"Cantidad"},nn=["onUpdate:modelValue","onChange"],rn={"data-label":"Cantidad a recibir"},on={"data-label":"Precio total producto"},an={"data-label":"Acciones"},sn=["onClick"],ln={key:3,class:"mobile-cards",style:{"margin-bottom":"20px"}},dn={class:"card-body"},fn={class:"d-flex justify-content-between align-items-start mb-2"},un={class:"product-info"},hn={class:"card-title mb-1"},gn={class:"text-muted small"},vn={class:"price-info"},cn={class:"fw-bold text-success fs-5"},pn={class:"text-muted small"},yn={class:"mb-1"},mn={class:"badge bg-info text-dark ms-1"},wn={key:0},bn={class:"badge bg-warning text-dark ms-1"},xn={class:"quantity-controls p-2 rounded bg-light"},Sn={class:"d-flex align-items-center justify-content-between flex-wrap gap-2"},Pn={class:"d-flex align-items-center"},Cn=["onUpdate:modelValue","onChange"],Fn={class:"ms-2"},Dn={class:"badge bg-success"},Hn={class:"quantity-controls p-2 rounded bg-light mt-2"},Wn={class:"ms-2"},kn={class:"d-grid mt-3"},Tn=["onClick"],_n={key:3,class:"alert alert-info mt-4"},Rn={__name:"CarritoView",setup(e){const t=At(),r=_(0),n=_([]),o=_(0),i=_(!1),l=_(!1),s=_({Nombre:"",Ciudad:"",Fecha:"",Vendedor:""}),d=_(0),a=_(0),f=_(0),v=()=>{d.value=0,a.value=0,f.value=0,n.value.forEach(w=>{const h=w.PrecioFarmacia*w.cantidad,g=Number(w.IVA);g>0?(d.value+=h,f.value+=h*(g/100)):a.value+=h}),o.value=d.value+a.value+f.value};zt(()=>{const w=JSON.parse(localStorage.getItem("carrito"))||[];n.value=w,c(),v(),s.value.Fecha=new Date().toISOString().split("T")[0];const h=window.matchMedia("(max-width: 767px)"),g=y=>{i.value=y.matches!==void 0?y.matches:h.matches};g(h);try{h.addEventListener("change",g)}catch{h.addListener(g)}Et(()=>{try{h.removeEventListener("change",g)}catch{h.removeListener(g)}})});const c=()=>{o.value=n.value.reduce((w,h)=>{const g=h.IVA>0?h.IVA:0,y=h.PrecioFarmacia*h.cantidad*(1+g/100);return w+y},0)},p=(w,h,g)=>{n.value[w].cantidad<1&&(n.value[w].cantidad=1),localStorage.setItem("carrito",JSON.stringify(n.value)),c(),v(),r.value=L(h,g).total},m=w=>{try{q.confirm("Confirmar eliminaci√≥n","¬øDesea eliminar este producto del carrito?",function(){n.value.splice(w,1),localStorage.setItem("carrito",JSON.stringify(n.value)),c(),v(),t.success("Producto eliminado")},function(){})}catch{n.value.splice(w,1),localStorage.setItem("carrito",JSON.stringify(n.value)),c(),v()}},C=async()=>{const h=["Nombre","Ciudad","Fecha","Vendedor","Tipo"].filter(g=>!s.value[g]);if(h.length){q.alert(`‚ùå Faltan campos obligatorios: ${h.join(", ")}`);return}l.value=!0;try{const g=new jt.Workbook,y=g.addWorksheet(s.value.Tipo);y.addRow([`Datos ${s.value.Tipo}`]),y.addRow(["Nombre",s.value.Nombre]),y.addRow(["Ciudad",s.value.Ciudad]),y.addRow(["Fecha",s.value.Fecha]),y.addRow(["Vendedor",s.value.Vendedor]),y.addRow(["Tipo",s.value.Tipo]),y.addRow([]);let H=[],$=[];s.value.Tipo==="Pedido"&&(H=["Cantidad","Promoci√≥n","Nombre Producto","Lote","Fecha de Vencimiento"],$=n.value.map(x=>{const{promo:T,total:z,detalle:W,cantidad:U}=L(x.cantidad,x.Promocion);return[x.cantidad,T,x.NombreProducto,"",""]})),s.value.Tipo==="Proforma"&&(H=["Cantidad","Promoci√≥n","Nombre Producto","Marca","Precio Farmacia","Total"],$=n.value.map(x=>{const T=x.PrecioFarmacia*x.cantidad;return[x.cantidad,L(x.cantidad,x.Promocion).promo,x.NombreProducto,x.Marca,x.PrecioFarmacia,T.toFixed(2)]}));const V=y.addRow(H);if(V.height=30,V.eachCell(x=>{x.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFCCE5FF"}},x.font={bold:!0,size:12,color:{argb:"FF000000"}},x.alignment={horizontal:"center",vertical:"middle",wrapText:!0},x.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}}}),s.value.Tipo==="Pedido"&&(y.getColumn(1).width=15,y.getColumn(2).width=15,y.getColumn(3).width=35,y.getColumn(4).width=40,y.getColumn(5).width=40),s.value.Tipo==="Proforma"&&(y.getColumn(1).width=15,y.getColumn(2).width=15,y.getColumn(3).width=35,y.getColumn(4).width=35,y.getColumn(5).width=15,y.getColumn(6).width=20),$.forEach(x=>{const T=y.addRow(x);T.height=55,T.eachCell(z=>{z.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},z.alignment={vertical:"middle",horizontal:"center",wrapText:!0}})}),s.value.Tipo==="Proforma"){y.addRow([]);const x=y.addRow(["","","","","Subtotal 15%:",`$ ${d.value.toFixed(2)}`]),T=y.addRow(["","","","","Subtotal 0%:",`$ ${a.value.toFixed(2)}`]),z=y.addRow(["","","","","IVA 15%:",`$ ${f.value.toFixed(2)}`]),W=y.addRow(["","","","","VALOR TOTAL:",`$ ${o.value.toFixed(2)}`]);[x,T,z,W].forEach(U=>{U.eachCell(J=>{J.value?.toString().trim()&&(J.border={top:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"},right:{style:"thin"}},J.alignment={vertical:"middle",horizontal:"center",wrapText:!0},J.font={bold:!0})})})}const O=await g.xlsx.writeBuffer(),Y=`${s.value.Tipo}_Cliente_${s.value.Nombre}_ciudad_${s.value.Ciudad}_Cliente_${s.value.Fecha}.xlsx`;Bt.saveAs(new Blob([O]),Y),t.success("Excel generado correctamente")}catch(g){console.error("Error generando Excel:",g),t.error("Ocurri√≥ un error al generar el Excel")}finally{l.value=!1}},b=async()=>{try{q.confirm("Vaciar carrito","¬øEst√° seguro que desea vaciar todo el carrito? Esta acci√≥n no se puede deshacer.",function(){localStorage.removeItem("carrito"),n.value=[],c(),v(),t.success("Carrito vaciado")},function(){})}catch{localStorage.removeItem("carrito"),n.value=[]}},P=async()=>{if(!s.value.Nombre.trim()){q.alert("Campo obligatorio","‚ùå Por favor, ingrese el nombre del cliente antes de exportar");return}l.value=!0;try{const w=new Date().toISOString().split("T")[0],h=s.value.Nombre.trim().replace(/\s+/g,"_"),g=new Mt({orientation:"portrait",unit:"pt",format:"a4"}),y=g.internal.pageSize.getWidth(),H=g.internal.pageSize.getHeight(),V=await k("/logo_mh.png"),O=40,Y=100,x=()=>{g.addImage(V,"PNG",40,20,O,O),g.setFontSize(14),g.text("Lista Productos MH",y/2,40,{align:"center"}),g.setFontSize(11),g.text(`Cliente: ${s.value.Nombre}`,y/2,60,{align:"center"}),g.text(`Fecha: ${w}`,y/2,80,{align:"center"})};x();const T=["Producto","Marca","Presentaci√≥n","Precio","Promoci√≥n","Descuento %"],z=n.value.map(W=>[W.NombreProducto||"",W.Marca||"",W.Presentacion||"",W.PrecioFarmacia!=null?"$"+Number(W.PrecioFarmacia).toFixed(2):"N/D",W.Promocion||"",W.Descuento&&!isNaN(Number(W.Descuento))?W.Descuento+" %":""]);Pe(g,{startY:Y,head:[T],body:z,theme:"grid",margin:{top:Y+10},headStyles:{fillColor:[21,28,166],textColor:"#fff",fontSize:10},bodyStyles:{fontSize:9},styles:{cellPadding:3,halign:"center",valign:"middle"},columnStyles:{0:{halign:"left"}},didDrawPage:W=>{const U=g.internal.getNumberOfPages();g.setFontSize(10),g.text(`P√°gina ${U}`,y-50,H-20,{align:"right"}),x()}}),g.save(`Lista_MH_${h}_${w}.pdf`),t.success("PDF generado correctamente")}catch(w){console.error(w),t.error("Error al generar PDF")}finally{l.value=!1}};function k(w){return new Promise(h=>{const g=new Image;g.src=w,g.onload=()=>h(g)})}return(w,h)=>(D(),F("div",Ce,[h[28]||(h[28]=u("h2",{class:"text-center mb-4"},"üõí Carrito de Compras",-1)),n.value.length?(D(),F("div",Fe,[u("div",De,[h[5]||(h[5]=u("label",{class:"form-label"},"Nombre cliente",-1)),E(u("input",{"onUpdate:modelValue":h[0]||(h[0]=g=>s.value.Nombre=g),type:"text",class:"form-control"},null,512),[[B,s.value.Nombre]])]),u("div",He,[h[6]||(h[6]=u("label",{class:"form-label"},"Ciudad",-1)),E(u("input",{"onUpdate:modelValue":h[1]||(h[1]=g=>s.value.Ciudad=g),type:"text",class:"form-control"},null,512),[[B,s.value.Ciudad]])]),u("div",We,[h[7]||(h[7]=u("label",{class:"form-label"},"Fecha",-1)),E(u("input",{"onUpdate:modelValue":h[2]||(h[2]=g=>s.value.Fecha=g),type:"date",readonly:"",disabled:"",class:"form-control"},null,512),[[B,s.value.Fecha]])]),u("div",ke,[h[9]||(h[9]=u("label",{class:"form-label"},"Vendedor",-1)),E(u("select",{"onUpdate:modelValue":h[3]||(h[3]=g=>s.value.Vendedor=g),class:"form-select"},[...h[8]||(h[8]=[u("option",{value:"",disabled:"",selected:""},"Seleccione",-1),u("option",{value:"Diana Benalc√°zar"},"Diana Benalc√°zar",-1)])],512),[[at,s.value.Vendedor]])]),u("div",Te,[h[11]||(h[11]=u("label",{class:"form-label"},"Tipo de documento",-1)),E(u("select",{"onUpdate:modelValue":h[4]||(h[4]=g=>s.value.Tipo=g),class:"form-select"},[...h[10]||(h[10]=[u("option",{value:"",disabled:"",selected:""},"Seleccione",-1),u("option",{value:"Pedido"},"Pedido",-1),u("option",{value:"Proforma"},"Proforma",-1)])],512),[[at,s.value.Tipo]])])])):j("",!0),h[29]||(h[29]=u("hr",{style:{border:"solid 1px silver"}},null,-1)),n.value.length?(D(),F("div",_e,[u("button",{onClick:b,class:"btn btn-warning"}," Vaciar carrito "),u("button",{class:"btn btn-primary",onClick:C,disabled:!n.value.length}," Exportar Excel ",8,Re),u("button",{class:"btn btn-success",onClick:P,disabled:!n.value.length}," Exportar PDF ",8,Ae)])):j("",!0),h[30]||(h[30]=u("hr",{style:{border:"solid 1px silver"}},null,-1)),n.value.length?(D(),F("div",ze,[l.value?(D(),F("div",Ee,[...h[12]||(h[12]=[u("div",{class:"export-spinner","aria-hidden":"true"},null,-1),u("div",{class:"export-text"},"Generando archivo, por favor espere...",-1)])])):j("",!0),n.value.length?(D(),F("div",Ne,[u("div",je,[u("div",Be,[u("ul",Me,[u("li",Le,[h[13]||(h[13]=u("strong",null,"Subtotal 15%:",-1)),u("span",null,"$ "+S(d.value.toFixed(2)),1)]),u("li",Ie,[h[14]||(h[14]=u("strong",null,"Subtotal 0%:",-1)),u("span",null,"$ "+S(a.value.toFixed(2)),1)]),u("li",$e,[h[15]||(h[15]=u("strong",null,"IVA 15%:",-1)),u("span",null,"$ "+S(f.value.toFixed(2)),1)]),u("li",Ve,[h[16]||(h[16]=u("strong",null,"Total:",-1)),u("span",Oe,"$ "+S(o.value.toFixed(2)),1)])])])])])):j("",!0),h[27]||(h[27]=u("hr",{style:{border:"solid 1px silver"}},null,-1)),i.value?(D(),F("div",ln,[(D(!0),F(st,null,lt(n.value,(g,y)=>(D(),F("div",{key:g.id,class:"card mb-3 mobile-card"},[u("div",dn,[u("div",fn,[u("div",un,[u("h5",hn,S(g.NombreProducto),1),u("div",gn,[u("div",null,[h[18]||(h[18]=u("strong",null,"Marca:",-1)),M(" "+S(g.Marca),1)]),u("div",null,[h[19]||(h[19]=u("strong",null,"Presentaci√≥n:",-1)),M(" "+S(g.Presentacion),1)]),u("div",null,[h[20]||(h[20]=u("strong",null,"P. Activo:",-1)),M(" "+S(g.PrincipioActivo||"-"),1)])])]),u("div",vn,[u("div",cn," $ "+S(Number(g.PrecioFarmacia).toFixed(2)),1),u("div",pn," IVA: "+S(g.IVA>0?g.IVA+"%":"No aplica"),1)])]),u("div",{class:Nt(["promo-info p-2 mb-2 rounded",g.Promocion?"bg-light":""])},[u("div",yn,[h[21]||(h[21]=u("strong",{class:"text-primary"},"Promoci√≥n:",-1)),u("span",mn,S(g.Promocion||"Sin promoci√≥n"),1)]),g.Descuento&&Number(g.Descuento)!==0?(D(),F("div",wn,[h[22]||(h[22]=u("strong",{class:"text-primary"},"Descuento:",-1)),u("span",bn,S(g.Descuento)+"%",1)])):j("",!0)],2),u("div",xn,[u("div",Sn,[u("div",Pn,[h[23]||(h[23]=u("label",{class:"me-2 fw-bold mb-0"},"Cantidad:",-1)),E(u("input",{type:"number",min:"0","onUpdate:modelValue":H=>g.cantidad=H,onChange:H=>p(y,g.cantidad,g.Promocion),class:"form-control",style:{width:"80px"}},null,40,Cn),[[B,g.cantidad,void 0,{number:!0}]])]),u("div",Fn,[h[24]||(h[24]=u("strong",null,"A recibir: ",-1)),u("span",Dn,S(K(L)(g.cantidad,g.Promocion).total),1)])])]),u("div",Hn,[u("div",Wn,[h[25]||(h[25]=u("strong",null,"Precio total: ",-1)),M(" $ "+S(K(dt)(g.cantidad,g.PrecioFarmacia).toFixed(2)),1)])]),u("div",kn,[u("button",{class:"btn btn-outline-danger",onClick:H=>m(y)},[...h[26]||(h[26]=[u("i",{class:"fas fa-trash-alt me-2"},null,-1),M("Eliminar producto ",-1)])],8,Tn)])])]))),128))])):(D(),F("div",Ye,[u("table",Ue,[h[17]||(h[17]=u("thead",null,[u("tr",null,[u("th",{class:"text-wrap fs-6 text"},"Nombre"),u("th",{class:"text-wrap fs-6 text"},"Presentaci√≥n"),u("th",{class:"text-wrap fs-6 text"},"Principio Activo"),u("th",{class:"text-wrap fs-6 text"},"P FARMACIA"),u("th",{class:"text-wrap fs-6 text"},"Promoci√≥n"),u("th",{class:"text-wrap fs-6 text"},"Descuento"),u("th",{class:"text-wrap fs-6 text"},"Marca"),u("th",{class:"text-wrap fs-6 text"},"IVA"),u("th",{class:"text-wrap fs-6 text"},"Cantidad"),u("th",{class:"text-wrap fs-6 text"},"A recibir"),u("th",{class:"text-wrap fs-6 text"},"Precio total producto"),u("th",{class:"text-wrap fs-6 text"},"Acciones")])],-1)),u("tbody",null,[(D(!0),F(st,null,lt(n.value,(g,y)=>(D(),F("tr",{key:g.id},[u("td",Je,S(g.NombreProducto),1),u("td",Ke,S(g.Presentacion),1),u("td",qe,S(g.PrincipioActivo),1),u("td",Ge,"$ "+S(g.PrecioFarmacia),1),u("td",Qe,S(g.Promocion),1),u("td",Xe,S(g.Descuento!==void 0&&g.Descuento!==null&&Number(g.Descuento)!==0?g.Descuento:""),1),u("td",Ze,S(g.Marca),1),u("td",tn,S(g.IVA>0?g.IVA+"%":"No aplica"),1),u("td",en,[E(u("input",{type:"number",min:"0","onUpdate:modelValue":H=>g.cantidad=H,onChange:H=>p(y,g.cantidad,g.Promocion),class:"form-control form-control-sm",style:{width:"80px"}},null,40,nn),[[B,g.cantidad,void 0,{number:!0}]])]),u("td",rn,S(K(L)(g.cantidad,g.Promocion).total),1),u("td",on," $ "+S(K(dt)(g.cantidad,g.PrecioFarmacia).toFixed(2)),1),u("td",an,[u("button",{class:"btn btn-danger btn-sm",onClick:H=>m(y)}," Eliminar ",8,sn)])]))),128))])])]))])):(D(),F("div",_n,"El carrito est√° vac√≠o."))]))}},Mn=Rt(Rn,[["__scopeId","data-v-4f8c30ae"]]);export{Mn as default};
