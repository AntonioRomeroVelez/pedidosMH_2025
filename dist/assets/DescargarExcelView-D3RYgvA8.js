import{u as r,w as x}from"./xlsx-hAyDQTdp.js";import{F as _}from"./FileSaver.min-BieAmd5U.js";import{a as n}from"./alertify-DPht8m50.js";import{b,d as g,e as a,h as f,i as y,a as h,f as w}from"./index-Bz6ZYZ6P.js";const k={class:"container py-5"},S={class:"text-center"},V={__name:"DescargarExcelView",setup(E){const l=()=>{const o=JSON.parse(localStorage.getItem("ListaProductos")||"[]");if(!o.length){n.error("❌ No hay productos para exportar");return}const t=r.json_to_sheet(o),e=r.book_new();r.book_append_sheet(e,t,"Productos");const s=new Date,i=s.getFullYear(),p=String(s.getMonth()+1).padStart(2,"0"),d=String(s.getDate()).padStart(2,"0"),c=`productos_${i}-${p}-${d}.xlsx`,m=x(e,{bookType:"xlsx",type:"array"}),u=new Blob([m],{type:"application/octet-stream"});_.saveAs(u,c),n.success(`✅ Excel descargado como ${c}`)};return(o,t)=>{const e=h("RouterLink");return g(),b("div",k,[t[1]||(t[1]=a("h2",{class:"text-primary fw-bold mb-4 text-center"}," 📥 Descargar Excel de productos ",-1)),a("div",S,[a("button",{class:"btn btn-success px-4 py-2",onClick:l}," 📁 Descargar Excel "),f(e,{class:"btn btn-outline-warning",to:"/gestionar"},{default:y(()=>[...t[0]||(t[0]=[w("Regresar",-1)])]),_:1})])])}}};export{V as default};
